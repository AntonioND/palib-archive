<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PA_lib:  Fichier source de PA_GBFS.h</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Généré par Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Page&nbsp;principale</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li id="current"><a href="files.html"><span>Fichiers</span></a></li>
    <li><a href="dirs.html"><span>Répertoires</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" callpadding="0" border="0">
          <tr>
            <td><label>&nbsp;Rechercher&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>Liste&nbsp;des&nbsp;fichiers</span></a></li>
    <li><a href="globals.html"><span>Portée&nbsp;globale</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_C_3A_2FdevkitPro_2F.html">devkitPro</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_C_3A_2FdevkitPro_2FPAlib_2F.html">PAlib</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_C_3A_2FdevkitPro_2FPAlib_2Finclude_2F.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_C_3A_2FdevkitPro_2FPAlib_2Finclude_2FNDS_2F.html">NDS</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_C_3A_2FdevkitPro_2FPAlib_2Finclude_2FNDS_2Farm9_2F.html">arm9</a></div>
<h1>PA_GBFS.h</h1><a href="_p_a___g_b_f_s_8h.html">Aller à la documentation de ce fichier.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef _PA_GBFS</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define _PA_GBFS</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 
<a name="l00010"></a>00010 <span class="preprocessor">#include "<a class="code" href="_p_a___text_8h.html">PA_Text.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include "gbfs.h"</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="keyword">typedef</span> <span class="keyword">struct</span>{
<a name="l00017"></a>00017        <span class="keywordtype">void</span> *File; <span class="comment">// Position du fichier...</span>
<a name="l00018"></a>00018        <span class="keywordtype">char</span> Name[30]; <span class="comment">// Nom du fichier, sans extension</span>
<a name="l00019"></a>00019        <span class="keywordtype">char</span> Ext[6]; <span class="comment">// Extension du fichier !</span>
<a name="l00020"></a>00020        u32 Length; <span class="comment">// Longueur</span>
<a name="l00021"></a>00021 } PA_GBFS_infos;
<a name="l00022"></a>00022 <span class="keyword">extern</span> PA_GBFS_infos PA_GBFSfile[200]; 
<a name="l00023"></a>00023 <span class="keyword">extern</span> s16 PA_GBFS_nfiles;
<a name="l00024"></a>00024 <span class="keyword">extern</span> GBFS_FILE <span class="keyword">const</span>* PA_GBFS_FILE;
<a name="l00025"></a>00025 
<a name="l00036"></a><a class="code" href="group___g_b_f_s.html#gc7c5de375dd522335fe0eb420e96d680">00036</a> <span class="keyword">extern</span> <span class="keyword">inline</span> u32 <a class="code" href="group___g_b_f_s.html#gc7c5de375dd522335fe0eb420e96d680">PA_InitGBFS</a>(<span class="keywordtype">void</span>){
<a name="l00037"></a>00037 s16 dot = 0;
<a name="l00038"></a>00038 s16 i = 0;
<a name="l00039"></a>00039 
<a name="l00040"></a>00040        WAIT_CR &amp;= ~0x80;
<a name="l00041"></a>00041  
<a name="l00042"></a>00042        PA_GBFS_FILE = find_first_gbfs_file((<span class="keywordtype">void</span>*)0x08000000);
<a name="l00043"></a>00043        PA_GBFS_nfiles = 0;
<a name="l00044"></a>00044        PA_GBFSfile[PA_GBFS_nfiles].File = (<span class="keywordtype">void</span>*)gbfs_get_nth_obj(PA_GBFS_FILE, PA_GBFS_nfiles, (<span class="keywordtype">char</span>*)PA_GBFSfile[PA_GBFS_nfiles].Name, &amp;PA_GBFSfile[PA_GBFS_nfiles].Length);
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="keywordflow">while</span>(PA_GBFSfile[PA_GBFS_nfiles].File != NULL){
<a name="l00047"></a>00047 
<a name="l00048"></a>00048        <span class="comment">// On cherche la fin du nom</span>
<a name="l00049"></a>00049        <span class="keywordflow">while</span>(PA_GBFSfile[PA_GBFS_nfiles].Name[i]) i++;
<a name="l00050"></a>00050        <span class="comment">// On en déduit le dernier point, pour avoir l'extension</span>
<a name="l00051"></a>00051        <span class="keywordflow">while</span>(PA_GBFSfile[PA_GBFS_nfiles].Name[i] != <span class="charliteral">'.'</span>) i--; <span class="comment">// On cherche l'extension</span>
<a name="l00052"></a>00052        dot = i+1;
<a name="l00053"></a>00053        
<a name="l00054"></a>00054        <span class="keywordflow">for</span> (i = 0; PA_GBFSfile[PA_GBFS_nfiles].Name[i+dot] ; i++){
<a name="l00055"></a>00055               PA_GBFSfile[PA_GBFS_nfiles].Ext[i] = PA_GBFSfile[PA_GBFS_nfiles].Name[i+dot];
<a name="l00056"></a>00056               PA_GBFSfile[PA_GBFS_nfiles].Ext[i+1] = 0;
<a name="l00057"></a>00057               PA_GBFSfile[PA_GBFS_nfiles].Name[i+dot-1] = 0;
<a name="l00058"></a>00058               <span class="keywordflow">if</span> (PA_GBFSfile[PA_GBFS_nfiles].Name[i+dot-2] == <span class="charliteral">'.'</span>) PA_GBFSfile[PA_GBFS_nfiles].Name[i+dot-2] = 0;
<a name="l00059"></a>00059        }
<a name="l00060"></a>00060        PA_GBFSfile[PA_GBFS_nfiles].Name[dot] = 0;
<a name="l00061"></a>00061        PA_GBFSfile[PA_GBFS_nfiles].Ext[dot] = 0;
<a name="l00062"></a>00062        
<a name="l00063"></a>00063        ++PA_GBFS_nfiles; <span class="comment">// On ajoute un objet...</span>
<a name="l00064"></a>00064        PA_GBFSfile[PA_GBFS_nfiles].File = (<span class="keywordtype">void</span>*)gbfs_get_nth_obj(PA_GBFS_FILE, PA_GBFS_nfiles, (<span class="keywordtype">char</span>*)PA_GBFSfile[PA_GBFS_nfiles].Name, &amp;PA_GBFSfile[PA_GBFS_nfiles].Length);
<a name="l00065"></a>00065 }
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="keywordflow">return</span> PA_GBFS_nfiles;
<a name="l00068"></a>00068 }
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 
<a name="l00086"></a><a class="code" href="group___g_b_f_s.html#g9e9eecffba9c422a9bdac52436f7f695">00086</a> <span class="keyword">extern</span> <span class="keyword">inline</span> s32 <a class="code" href="group___g_b_f_s.html#g9e9eecffba9c422a9bdac52436f7f695">PA_GetGBFSFile</a>(s16 start, <span class="keywordtype">char</span> *name, <span class="keywordtype">char</span> *extension){
<a name="l00087"></a>00087 s16 i;
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 <span class="keywordflow">for</span> (i = start; i &lt; PA_GBFS_nfiles; i++){
<a name="l00090"></a>00090        <span class="keywordflow">if</span> (<a class="code" href="group___text.html#gb13c11c758a7c329bd2d126434ddc8cc">PA_CompareText</a>(PA_GBFSfile[i].Name, name)&amp;&amp; <a class="code" href="group___text.html#gb13c11c758a7c329bd2d126434ddc8cc">PA_CompareText</a>(PA_GBFSfile[i].Ext, extension)) 
<a name="l00091"></a>00091               <span class="keywordflow">return</span> i;
<a name="l00092"></a>00092 }
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="keywordflow">return</span> -1;
<a name="l00095"></a>00095 }
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 
<a name="l00109"></a>00109 s16 <a class="code" href="group___g_b_f_s.html#ge170a01cd1ddbcc27ae84698d4782aa7">PA_GBFSSearchExt</a>(s16 *array, <span class="keywordtype">char</span> *extension);
<a name="l00110"></a>00110 
<a name="l00111"></a>00111  <span class="comment">// end of GBFS</span>
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 <span class="preprocessor">#endif</span>
<a name="l00117"></a>00117 <span class="preprocessor"></span>
<a name="l00118"></a>00118 
</pre></div><hr size="1"><address style="align: right;"><small>Généré le Tue Oct 18 13:31:44 2005 pour PA_lib par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
