<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PAlib: PA_Draw.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>PA_Draw.h</h1><a href="_p_a___draw_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef _PA_Buffer</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define _PA_Buffer</span>
00003 <span class="preprocessor"></span>
00004 
00005 
00012 <span class="preprocessor">#include "<a class="code" href="_p_a9_8h.html">PA9.h</a>"</span>
00013 
00014 <span class="preprocessor">#include "<a class="code" href="_p_a___interrupt_8h.html">PA_Interrupt.h</a>"</span>
00015 <span class="preprocessor">#include "gif/gif_lib.h"</span>
00016 
00017 <span class="keyword">extern</span> GifFileType* gifinfo;
00018 <span class="keyword">extern</span> s16 gifwidth, gifheight; 
00019 <span class="keyword">extern</span> u8 PA_nBit[2]; <span class="comment">// 8 or 16 bit Bg</span>
00020 
00021 
00022 <span class="preprocessor">#define PA_RGB8(r,g,b)      ((((b)&gt;&gt;3)&lt;&lt;10)|(((g)&gt;&gt;3)&lt;&lt;5)|((r)&gt;&gt;3)|(1 &lt;&lt; 15))</span>
00023 <span class="preprocessor"></span>
00024 
00025 <span class="keyword">typedef</span> <span class="keyword">struct</span>{
00026        u16 Id; <span class="comment">// ?</span>
00027        u32 Length;
00028        u16 Nothing1, Nothing2; <span class="comment">// ?</span>
00029        u32 ImageStart; <span class="comment">// Offset of start of image</span>
00030 } BMPHeader0;
00031 
00032 <span class="keyword">typedef</span> <span class="keyword">struct</span>{
00033        u32 SizeofHeader; <span class="comment">// 40</span>
00034        u32 Width, Height;
00035        u16 Colorplanes; <span class="comment">// Usually 1</span>
00036        u16 BitsperPixel; <span class="comment">//1, 2, 4, 8, 16, 24, 32</span>
00037        u32 Compression;  <span class="comment">// 0 for none, 1...</span>
00038        u32 SizeofData; <span class="comment">// Not reliable</span>
00039        u32 WidthperMeter, HeightperMeter; <span class="comment">// Don't care</span>
00040        u32 NColors, ImportantColors; <span class="comment">// Number of colors used, important colors ?</span>
00041 } BMP_Headers;
00042 
00043 
00044 <span class="keyword">extern</span> u16 PA_oldx[2];
00045 <span class="keyword">extern</span> u16 PA_oldy[2];
00046 <span class="keyword">extern</span> u8 PA_drawsize[2];
00047 <span class="keyword">extern</span> u16 *PA_DrawBg[2];
00048 <span class="keyword">extern</span> u8 PA_nBit[2]; <span class="comment">// 8 or 16 bit Bg</span>
00049 <span class="comment">//extern PA_SCreen</span>
00050 
00051 <span class="keywordtype">void</span> PA_Load16bitGif(<span class="keywordtype">bool</span> screen, s16 x, s16 y, <span class="keywordtype">void</span> *gif);
00052 <span class="keywordtype">int</span> DecodeGif(<span class="keyword">const</span> u8 *userData, u8 *ScreenBuff, u16* Palette, u8 nBits, s16 SWidth);
00053 
00054 
00055 
00073 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga0">PA_Init8bitBg</a>(<span class="keywordtype">bool</span> screen, u8 bg_priority);
00074 
00075 
00087 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga1">PA_Init16bitBg</a>(<span class="keywordtype">bool</span> screen, u8 bg_priority);
00088 
00089 
00090 
<a name="l00108"></a><a class="code" href="group___bitmap.html#ga2">00108</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga2">PA_Put8bitPixel</a>(<span class="keywordtype">bool</span> screen, s16 x, s16 y, u8 color) {
00109        u16 pos =     (x &gt;&gt; 1) + (y &lt;&lt; 7);
00110        <span class="keywordflow">if</span> (x&amp;1){
00111               PA_DrawBg[screen][pos] &amp;= 255;
00112               PA_DrawBg[screen][pos] |= color &lt;&lt; 8;                   
00113        }
00114        <span class="keywordflow">else</span> {
00115               PA_DrawBg[screen][pos] &amp;= 255 &lt;&lt; 8;
00116               PA_DrawBg[screen][pos] |= color;
00117        }
00118 }
00119 
00120 
<a name="l00139"></a><a class="code" href="group___bitmap.html#ga3">00139</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga3">PA_Put2_8bitPixels</a>(<span class="keywordtype">bool</span> screen, s16 x, s16 y, u16 colors) {             PA_DrawBg[screen][(x &gt;&gt; 1) + (y &lt;&lt; 7)] = colors;
00140 }
00141 
<a name="l00162"></a><a class="code" href="group___bitmap.html#ga4">00162</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga4">PA_PutDouble8bitPixels</a>(<span class="keywordtype">bool</span> screen, s16 x, s16 y, u8 color1, u8 color2) {
00163        <a class="code" href="group___bitmap.html#ga3">PA_Put2_8bitPixels</a>(screen, x, y, color1 + (color2 &lt;&lt; 8));             
00164 }
00165 
00166 
00167 
<a name="l00186"></a><a class="code" href="group___bitmap.html#ga5">00186</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga5">PA_Put4_8bitPixels</a>(<span class="keywordtype">bool</span> screen, s16 x, s16 y, u32 colors) {
00187 <span class="comment">/*</span>
00188 <span class="comment">       (*u32*)(PA_DrawBg[screen] + (x &gt;&gt; 1) + (y &lt;&lt; 7)) = colors;*/</span>
00189 }
00190 
00191 
<a name="l00206"></a><a class="code" href="group___bitmap.html#ga6">00206</a> <span class="keyword">extern</span> <span class="keyword">inline</span> u8 <a class="code" href="group___bitmap.html#ga6">PA_Get8bitPixel</a>(<span class="keywordtype">bool</span> screen, u8 x, u8 y) {
00207        u16 pos =     (x &gt;&gt; 1) + (y &lt;&lt; 7);
00208        <span class="keywordflow">if</span> (x&amp;1){
00209               <span class="keywordflow">return</span> (PA_DrawBg[screen][pos] &gt;&gt; 8);
00210        }
00211        <span class="keywordflow">else</span> {
00212               <span class="keywordflow">return</span> (PA_DrawBg[screen][pos]);
00213        }
00214 }
00215 
00216 
00217 
00218 
<a name="l00236"></a><a class="code" href="group___bitmap.html#ga7">00236</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga7">PA_Put16bitPixel</a>(<span class="keywordtype">bool</span> screen, s16 x, s16 y, u16 color) {
00237        PA_DrawBg[screen][x + (y &lt;&lt; 8)] = color;
00238 }
00239 
00240 
<a name="l00255"></a><a class="code" href="group___bitmap.html#ga23">00255</a> <span class="preprocessor">#define PA_Get16bitPixel(screen, x, y) PA_DrawBg[screen][x + (y &lt;&lt; 8)]</span>
00256 <span class="preprocessor"></span>
00257 
00258 
00259 
00260 
00261 
00285 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga8">PA_Draw8bitLine</a>(<span class="keywordtype">bool</span> screen, u16 x1, u16 y1, u16 x2, u16 y2, u8 color);
00286 
00287 
00288 
00289 
00290 
00314 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga9">PA_Draw16bitLine</a>(<span class="keywordtype">bool</span> screen, u16 x1, u16 y1, u16 x2, u16 y2, u16 color);
00315 
00342 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga10">PA_Draw16bitLineEx</a>(<span class="keywordtype">bool</span> screen, s16 basex, s16 basey, s16 endx, s16 endy, u16 color, s8 size);
00343 
00344 
00345 
00346 
00370 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga11">PA_Draw16bitRect</a>(<span class="keywordtype">bool</span> screen, s16 basex, s16 basey, s16 endx, s16 endy, u16 color);
00371 
00372 
00384 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga12">PA_8bitDraw</a>(<span class="keywordtype">bool</span> screen, u8 color);
00385 
00386 
00398 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga13">PA_16bitDraw</a>(<span class="keywordtype">bool</span> screen, u16 color);
00399 
00400 
<a name="l00412"></a><a class="code" href="group___bitmap.html#ga24">00412</a> <span class="preprocessor">#define PA_SetDrawSize(screen, draw_size) PA_drawsize[screen] = draw_size;</span>
00413 <span class="preprocessor"></span>
00414 
00415 
00416 
00417 
<a name="l00429"></a><a class="code" href="group___bitmap.html#ga25">00429</a> <span class="preprocessor">#define PA_Load8bitBitmap(screen, bitmap) DMA_Copy(bitmap, (void*)PA_DrawBg[screen], 256*96, DMA_16NOW);</span>
00430 <span class="preprocessor"></span>
<a name="l00442"></a><a class="code" href="group___bitmap.html#ga26">00442</a> <span class="preprocessor">#define PA_Load16bitBitmap(screen, bitmap) {u32 PA_temp; \</span>
00443 <span class="preprocessor">for (PA_temp = 0; PA_temp &lt; 256*192; PA_temp++)\</span>
00444 <span class="preprocessor">PA_DrawBg[screen][PA_temp] = bitmap[PA_temp] + (1 &lt;&lt; 15);}</span>
00445 <span class="preprocessor"></span>
00446 
<a name="l00455"></a><a class="code" href="group___bitmap.html#ga27">00455</a> <span class="preprocessor">#define PA_Clear8bitBg(screen) DMA_Copy(Blank, (void*)PA_DrawBg[screen], 256*96, DMA_16NOW);</span>
00456 <span class="preprocessor"></span>
<a name="l00465"></a><a class="code" href="group___bitmap.html#ga28">00465</a> <span class="preprocessor">#define PA_Clear16bitBg(screen) DMA_Copy(Blank, (void*)PA_DrawBg[screen], 256*192, DMA_16NOW)</span>
00466 <span class="preprocessor"></span>
00467 
<a name="l00479"></a><a class="code" href="group___bitmap.html#ga14">00479</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga14">PA_LoadJpeg</a>(<span class="keywordtype">bool</span> screen, <span class="keywordtype">void</span> *jpeg) {
00480        REG_IME = 0x00;
00481        JPEG_DecompressImage((u8*)jpeg, PA_DrawBg[screen], 256, 192);
00482        REG_IME = 0x01;      
00483 }
00484 
00485 
00486 
00507 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga15">PA_LoadBmpToBuffer</a>(u16 *Buffer, s16 x, s16 y, <span class="keywordtype">void</span> *bmp, s16 SWidth);
00508 
00509 
<a name="l00527"></a><a class="code" href="group___bitmap.html#ga16">00527</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga16">PA_LoadBmpEx</a>(<span class="keywordtype">bool</span> screen, s16 x, s16 y, <span class="keywordtype">void</span> *bmp){
00528 <a class="code" href="group___bitmap.html#ga15">PA_LoadBmpToBuffer</a>(PA_DrawBg[screen], x, y, bmp, 256);
00529 }
00530 
00531 
00532 
<a name="l00544"></a><a class="code" href="group___bitmap.html#ga17">00544</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga17">PA_LoadBmp</a>(<span class="keywordtype">bool</span> screen, <span class="keywordtype">void</span> *bmp){
00545        <a class="code" href="group___bitmap.html#ga16">PA_LoadBmpEx</a>(screen, 0, 0, bmp);
00546 }
00547 
<a name="l00559"></a><a class="code" href="group___bitmap.html#ga18">00559</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga18">PA_LoadGif</a>(<span class="keywordtype">bool</span> screen, <span class="keywordtype">void</span> *gif){
00560        <span class="keywordflow">if</span> (PA_nBit[screen]) DecodeGif((<span class="keyword">const</span> u8*)gif, (u8*)PA_DrawBg[screen], (u16*)0x05000000, 1, 256);
00561        <span class="comment">//PA_Load16bitGif(screen, 0, 0, gif); // 16 bit...</span>
00562        <span class="keywordflow">else</span> DecodeGif((<span class="keyword">const</span> u8*)gif, (u8*)PA_DrawBg[screen], (u16*)(0x05000000+(0x400*screen)), 0, 256);
00563 }
00564 
00565 
00566 <span class="comment">/* // Les différentes fonctions images...</span>
00567 <span class="comment">extern inline void PA_LoadJpeg(bool screen, void *jpeg)</span>
00568 <span class="comment">void PA_LoadBmp(bool screen, s16 x, s16 y, void *bmp);*/</span>
00569 
00570 
<a name="l00582"></a><a class="code" href="group___bitmap.html#ga19">00582</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga19">PA_LoadGBFSImage</a>(<span class="keywordtype">bool</span> screen, s16 GBFSImage){
00583        <span class="keywordflow">if</span> (<a class="code" href="group___text.html#ga11">PA_CompareText</a>(PA_GBFSfile[GBFSImage].Ext, <span class="stringliteral">"bmp"</span>)){
00584               <a class="code" href="group___bitmap.html#ga17">PA_LoadBmp</a>(screen, PA_GBFSfile[GBFSImage].File);
00585        }
00586        <span class="keywordflow">if</span> (<a class="code" href="group___text.html#ga11">PA_CompareText</a>(PA_GBFSfile[GBFSImage].Ext, <span class="stringliteral">"jpg"</span>)){ 
00587               <a class="code" href="group___bitmap.html#ga14">PA_LoadJpeg</a>(screen, PA_GBFSfile[GBFSImage].File);
00588        }      
00589        <span class="keywordflow">if</span> (<a class="code" href="group___text.html#ga11">PA_CompareText</a>(PA_GBFSfile[GBFSImage].Ext, <span class="stringliteral">"gif"</span>)){ 
00590               <a class="code" href="group___bitmap.html#ga18">PA_LoadGif</a>(screen, PA_GBFSfile[GBFSImage].File);
00591        }             
00592 }
00593 
00594 <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> PA_LoadGBFSImageToBuffer(<span class="keywordtype">void</span> *Buffer, s16 GBFSImage, s16 Width){
00595        <span class="keywordflow">if</span> (<a class="code" href="group___text.html#ga11">PA_CompareText</a>(PA_GBFSfile[GBFSImage].Ext, <span class="stringliteral">"bmp"</span>)){
00596               <a class="code" href="group___bitmap.html#ga15">PA_LoadBmpToBuffer</a>((u16*)Buffer, 0, 0, (u16*)PA_GBFSfile[GBFSImage].File, Width);
00597        }
00598        <span class="comment">/*if (PA_CompareText(PA_GBFSfile[GBFSImage].Ext, "jpg")){ </span>
00599 <span class="comment">              PA_LoadJpeg(screen, PA_GBFSfile[GBFSImage].File);</span>
00600 <span class="comment">       }      */</span>
00601        <span class="keywordflow">if</span> (<a class="code" href="group___text.html#ga11">PA_CompareText</a>(PA_GBFSfile[GBFSImage].Ext, <span class="stringliteral">"gif"</span>)){ 
00602               DecodeGif((<span class="keyword">const</span> u8*)PA_GBFSfile[GBFSImage].File, (u8*)Buffer, (u16*)0x05000000, 1, Width);
00603        }             
00604 }
00605 
00606 <span class="keyword">extern</span> <span class="keyword">inline</span> u16 PA_GetBmpWidth(<span class="keywordtype">void</span> *bmp){
00607        u8 *temp = (u8*)bmp;
00608        BMP_Headers *Bmpinfo = (BMP_Headers*)(temp+14);
00609        <span class="keywordflow">return</span> Bmpinfo-&gt;Width;
00610 }
00611 <span class="keyword">extern</span> <span class="keyword">inline</span> u16 PA_GetBmpHeight(<span class="keywordtype">void</span> *bmp){
00612        u8 *temp = (u8*)bmp;
00613        BMP_Headers *Bmpinfo = (BMP_Headers*)(temp+14);
00614        <span class="keywordflow">return</span> Bmpinfo-&gt;Height;
00615 } <span class="comment">// end of Draw</span>
00617 
00618 
00619 <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> PA_8bit8x8Image(<span class="keywordtype">bool</span> screen, u16 basex, u16 basey, u8* data){
00620 s16 x, y;
00621 
00622 <span class="keywordflow">for</span> (x = 0; x &lt; 8; x++)
00623        <span class="keywordflow">for</span> (y = 0; y &lt; 8; y++)
00624               <a class="code" href="group___bitmap.html#ga2">PA_Put8bitPixel</a>(screen, x + basex, y + basey, data[x + (y &lt;&lt; 3)]);
00625 }
00626 
00627 <span class="comment">/*</span>
00628 <span class="comment">extern inline void PA_DrawImage(bool screen, s16 x, s16 y, s16 lx, s16 ly, u8* data){</span>
00629 <span class="comment">s16 i, j;</span>
00630 <span class="comment">u16* data2 = (u16*)data;</span>
00631 <span class="comment"></span>
00632 <span class="comment">if (x&amp;1){ // Premier pixel à mettre tout seul peut-etre</span>
00633 <span class="comment">       for (j = 0; j &lt; ly; j++) PA_Put8bitPixel(screen, x, j + y, data[0]);</span>
00634 <span class="comment">       x++;</span>
00635 <span class="comment">       data2 = (u16*)(data + 1);</span>
00636 <span class="comment">}</span>
00637 <span class="comment"></span>
00638 <span class="comment">i = 0;</span>
00639 <span class="comment">// Tant qu'il reste au moins 2 pixels à mettre, on fait 2 par 2</span>
00640 <span class="comment">while(i &lt; (lx-2)){</span>
00641 <span class="comment">       for (j = 0; j &lt; ly; j++) {</span>
00642 <span class="comment">              PA_PutDouble8bitPixels(screen, i + x, j + y, data2[(i &gt;&gt; 1) + (j*lx)]);</span>
00643 <span class="comment">       }</span>
00644 <span class="comment">       i+=2;</span>
00645 <span class="comment">}</span>
00646 <span class="comment"></span>
00647 <span class="comment">if (!((i + x)&amp;1)){ // Dernier pixel à mettre tout seul peut-etre</span>
00648 <span class="comment">       for (j = 0; j &lt; ly; j++) PA_Put8bitPixel(screen, i + x, j + y, data2[(i &gt;&gt; 1) + (j*lx)]&amp;255);</span>
00649 <span class="comment">}</span>
00650 <span class="comment"></span>
00651 <span class="comment">}</span>
00652 <span class="comment">*/</span>
00653 
00654 
00655 
00656 
00657 
00658 
00659 
00660 
00661 
00662 
00663 
00664 
00665 
00666 
00667 
00668 
00669 
00670 
00671 
00672 
00673 <span class="preprocessor">#endif</span>
00674 <span class="preprocessor"></span>
00675 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Nov 8 13:21:07 2005 for PAlib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
