<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PAlib:  Fichier source de PA_16c.h</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Généré par Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Page&nbsp;principale</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">Liste&nbsp;des&nbsp;fichiers</a> | <a class="qindex" href="globals.html">Portée&nbsp;globale</a>  | <span class="search">Rechercher&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>PA_16c.h</h1><a href="_p_a__16c_8h.html">Aller à la documentation de ce fichier.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef _PA_16C</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define _PA_16C</span>
00003 <span class="preprocessor"></span>
00004 <span class="preprocessor">#ifdef __cplusplus</span>
00005 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00006 <span class="preprocessor">#endif</span>
00007 <span class="preprocessor"></span>
00014 <span class="preprocessor">#include "PA9.h"</span>
00015 
00016 <span class="preprocessor">#include "<a class="code" href="_p_a___palette_8h.html">PA_Palette.h</a>"</span>
00017 
00018 
00019 <span class="comment">// Pointers...</span>
00020 <span class="keyword">extern</span> u16 *PA_Draw16[2];
00021 <span class="keyword">extern</span> u32 *PA_Draw1632[2];
00022 
00023 <span class="keyword">extern</span> u32 Blank[130000&gt;&gt;2];
00024 
00025 <span class="keyword">typedef</span> <span class="keyword">struct</span>{
00026        s32 NLetters;
00027        <span class="keyword">struct</span>{
00028               s16 X, X2, Y;
00029        }Letter[2048];
00030 } LetterPos16c;
00031 <span class="keyword">extern</span> LetterPos16c PA_16cLetterPos;
00032 
00033 
00034 
00035 <span class="preprocessor">#define PA_LoadPal16c(palette, source)   DMA_Copy(source, (void*)palette, 16, DMA_16NOW);</span>
00036 <span class="preprocessor"></span><span class="preprocessor">#define PA_16cPos(x, y) (((x&gt;&gt;3)*26*8) + y + 8)</span>
00037 <span class="preprocessor"></span>ALWAYSINLINE <span class="keywordtype">void</span> <a class="code" href="group__c.html#ga9">PA_16c8X8</a>(u8 screen, s16 x, s16 y, u32 *image);
00038 
00039        <span class="keyword">extern</span> u32 *c16_tiles[10];
00040        <span class="keyword">extern</span> u16 *c16_maps[10];
00041        <span class="keyword">extern</span> u8 *pa16cdefaultsize[10];
00042        <span class="keyword">extern</span> u8 c16policeheight[10];
00043        
00044 ALWAYSINLINE <span class="keywordtype">void</span> PA_16c8X8Color(u8 screen, s16 x, s16 y, u32 *image, u8 color){  
00045    x += 8; y += 8;
00046    u16 temp = (x&amp;7)&lt;&lt;2;
00047    u16 pos = PA_16cPos(x, y);
00048    PA_Draw1632[screen][pos] |= (image[0]&lt;&lt;temp)*color;
00049    PA_Draw1632[screen][pos+1] |= (image[1]&lt;&lt;temp)*color;
00050    PA_Draw1632[screen][pos+2] |= (image[2]&lt;&lt;temp)*color;
00051    PA_Draw1632[screen][pos+3] |= (image[3]&lt;&lt;temp)*color;
00052    PA_Draw1632[screen][pos+4] |= (image[4]&lt;&lt;temp)*color;   
00053    PA_Draw1632[screen][pos+5] |= (image[5]&lt;&lt;temp)*color;
00054    PA_Draw1632[screen][pos+6] |= (image[6]&lt;&lt;temp)*color;
00055    PA_Draw1632[screen][pos+7] |= (image[7]&lt;&lt;temp)*color;  
00056    pos += (26*8); <span class="comment">// Next columns</span>
00057    temp = 32-temp;
00058    PA_Draw1632[screen][pos] |= (image[0]&gt;&gt;temp)*color;
00059    PA_Draw1632[screen][pos+1] |= (image[1]&gt;&gt;temp)*color;
00060    PA_Draw1632[screen][pos+2] |= (image[2]&gt;&gt;temp)*color;
00061    PA_Draw1632[screen][pos+3] |= (image[3]&gt;&gt;temp)*color;
00062    PA_Draw1632[screen][pos+4] |= (image[4]&gt;&gt;temp)*color;   
00063    PA_Draw1632[screen][pos+5] |= (image[5]&gt;&gt;temp)*color;
00064    PA_Draw1632[screen][pos+6] |= (image[6]&gt;&gt;temp)*color;
00065    PA_Draw1632[screen][pos+7] |= (image[7]&gt;&gt;temp)*color;      
00066 } 
00067 
00068  
00069 
00070 ALWAYSINLINE <span class="keywordtype">void</span> PA_Plot8Pixels(u8 screen, u16 pos, u16 temp, u32 color){
00071    PA_Draw1632[screen][pos] |= (color&lt;&lt;temp);
00072    PA_Draw1632[screen][pos+(26*8)] |= (color&gt;&gt;(32-temp));   
00073 }  
00074 
00075 ALWAYSINLINE <span class="keywordtype">void</span> PA_16c16X16Letter(u8 screen, s16 x, s16 y, u8 letter, u8 size, u8 color)
00076 {  
00077        u16 firstpos = ((letter&amp;31)&lt;&lt;1)+((letter &gt;&gt; 5)&lt;&lt;7);
00078        PA_16c8X8Color(screen, x, y, (c16_tiles[size]+(c16_maps[size][firstpos]&lt;&lt;3)), color);
00079        PA_16c8X8Color(screen, x, y+8, (c16_tiles[size]+(c16_maps[size][firstpos+64]&lt;&lt;3)), color);
00080        firstpos ++;
00081        PA_16c8X8Color(screen, x+8, y, (c16_tiles[size]+(c16_maps[size][firstpos]&lt;&lt;3)), color);
00082        PA_16c8X8Color(screen, x+8, y+8, (c16_tiles[size]+(c16_maps[size][firstpos+64]&lt;&lt;3)), color);      
00083 }  
00084 
00085 <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> PA_16c8X8Letter(u8 screen, s16 x, s16 y, u8 letter, u8 size, u8 color){  
00086        PA_16c8X8Color(screen, x, y, (c16_tiles[size]+(c16_maps[size][letter]&lt;&lt;3)), color);
00087 }  
00088 
00089 
00108 <span class="keywordtype">void</span> PA_Init16cBgEx(u8 screen, u8 bg, u8 npalette);
00109 
00110 
00111 
<a name="l00123"></a><a class="code" href="group__c.html#ga1">00123</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__c.html#ga1">PA_Init16cBg</a>(u8 screen, u8 bg){
00124        PA_Init16cBgEx(screen, bg, 0);
00125 }
00126 
00127 
00128 
00129 
00130 
<a name="l00139"></a><a class="code" href="group__c.html#ga2">00139</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__c.html#ga2">PA_16cErase</a>(u8 screen){
00140        DMA_Copy(Blank, PA_Draw1632[screen], 26*8*34, DMA_32NOW)
00141 }
00142 
00143 
00144 
<a name="l00150"></a><a class="code" href="group__c.html#ga3">00150</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__c.html#ga3">PA_Dual16cErase</a>(<span class="keywordtype">void</span>){
00151        <a class="code" href="group__c.html#ga2">PA_16cErase</a>(0); <a class="code" href="group__c.html#ga2">PA_16cErase</a>(1);
00152 }
00153 
00154 
<a name="l00166"></a><a class="code" href="group__c.html#ga4">00166</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__c.html#ga4">PA_InitComplete16c</a>(u8 bg, <span class="keywordtype">void</span> *Palette){
00167        PA_LoadPal16c(PAL_BG0, Palette);
00168        PA_LoadPal16c(PAL_BG1, Palette);   
00169        <a class="code" href="group__c.html#ga1">PA_Init16cBg</a>(0, bg); <a class="code" href="group__c.html#ga1">PA_Init16cBg</a>(1, bg);
00170 }
00171 
00172 
00173 
00174 
00207 s16 <a class="code" href="group__c.html#ga5">PA_16cText</a>(u8 screen, s16 basex, s16 basey, s16 maxx, s16 maxy, <span class="keywordtype">char</span>* text, u8 color, u8 size, s32 limit);
00208 
00209 
<a name="l00221"></a><a class="code" href="group__c.html#ga17">00221</a> <span class="preprocessor">#define PA_16cCustomFont(c16_slot, c16_font){\</span>
00222 <span class="preprocessor">       c16_maps[c16_slot] = (u16*)(void*)c16_font##_Map;              \</span>
00223 <span class="preprocessor">       c16_tiles[c16_slot] = (u32*)(void*)c16_font##_Tiles;    \</span>
00224 <span class="preprocessor">       pa16cdefaultsize[c16_slot] = (u8*)c16_font##_Sizes;     \</span>
00225 <span class="preprocessor">       c16policeheight[c16_slot] = c16_font##_Height;\</span>
00226 <span class="preprocessor">}</span>
00227 <span class="preprocessor"></span>
00228 
<a name="l00246"></a><a class="code" href="group__c.html#ga6">00246</a> ALWAYSINLINE <span class="keywordtype">void</span> <a class="code" href="group__c.html#ga6">PA_16cPutPixel</a>(u8 screen, s16 x, s16 y, u32 color){
00247    x += 8; y += 8;
00248    u16 temp = (x&amp;7)&lt;&lt;2;
00249    u16 pos = PA_16cPos(x, y);
00250    PA_Draw1632[screen][pos] |= (color&lt;&lt;temp);
00251 }
00252 
00253 
<a name="l00271"></a><a class="code" href="group__c.html#ga7">00271</a> ALWAYSINLINE <span class="keywordtype">void</span> <a class="code" href="group__c.html#ga7">PA_16c8X4</a>(u8 screen, s16 x, s16 y, u32 *image){  
00272    x += 8; y += 8;
00273    u16 temp = (x&amp;7)&lt;&lt;2;
00274    u16 pos = PA_16cPos(x, y);
00275    PA_Draw1632[screen][pos] |= (image[0]&lt;&lt;temp);
00276    PA_Draw1632[screen][pos+1] |= (image[1]&lt;&lt;temp);
00277    PA_Draw1632[screen][pos+2] |= (image[2]&lt;&lt;temp);
00278    PA_Draw1632[screen][pos+3] |= (image[3]&lt;&lt;temp);
00279    pos += (26*8); <span class="comment">// Next columns</span>
00280    temp = 32-temp;
00281    PA_Draw1632[screen][pos] |= (image[0]&gt;&gt;temp);
00282    PA_Draw1632[screen][pos+1] |= (image[1]&gt;&gt;temp);
00283    PA_Draw1632[screen][pos+2] |= (image[2]&gt;&gt;temp);
00284    PA_Draw1632[screen][pos+3] |= (image[3]&gt;&gt;temp);
00285 }  
00286 
00287 
<a name="l00305"></a><a class="code" href="group__c.html#ga8">00305</a> ALWAYSINLINE <span class="keywordtype">void</span> <a class="code" href="group__c.html#ga8">PA_16c8X6</a>(u8 screen, s16 x, s16 y, u32 *image){  
00306    
00307    x += 8; y += 8;
00308    u16 temp = (x&amp;7)&lt;&lt;2;
00309    u16 pos = PA_16cPos(x, y);
00310    PA_Plot8Pixels(screen, pos, temp, image[0]);
00311    PA_Plot8Pixels(screen, pos+1, temp, image[1]);  
00312    PA_Plot8Pixels(screen, pos+2, temp, image[2]);   
00313    PA_Plot8Pixels(screen, pos+3, temp, image[3]); 
00314    PA_Plot8Pixels(screen, pos+4, temp, image[4]);
00315    PA_Plot8Pixels(screen, pos+5, temp, image[5]);  
00316 }  
00317 
00318 
<a name="l00336"></a><a class="code" href="group__c.html#ga9">00336</a> ALWAYSINLINE <span class="keywordtype">void</span> <a class="code" href="group__c.html#ga9">PA_16c8X8</a>(u8 screen, s16 x, s16 y, u32 *image){  
00337    x += 8; y += 8;
00338    u16 temp = (x&amp;7)&lt;&lt;2;
00339    u16 pos = PA_16cPos(x, y);
00340    PA_Draw1632[screen][pos] |= (image[0]&lt;&lt;temp);
00341    PA_Draw1632[screen][pos+1] |= (image[1]&lt;&lt;temp);
00342    PA_Draw1632[screen][pos+2] |= (image[2]&lt;&lt;temp);
00343    PA_Draw1632[screen][pos+3] |= (image[3]&lt;&lt;temp);
00344    PA_Draw1632[screen][pos+4] |= (image[4]&lt;&lt;temp);   
00345    PA_Draw1632[screen][pos+5] |= (image[5]&lt;&lt;temp);
00346    PA_Draw1632[screen][pos+6] |= (image[6]&lt;&lt;temp);
00347    PA_Draw1632[screen][pos+7] |= (image[7]&lt;&lt;temp);  
00348    pos += (26*8); <span class="comment">// Next columns</span>
00349    temp = 32-temp;
00350    PA_Draw1632[screen][pos] |= (image[0]&gt;&gt;temp);
00351    PA_Draw1632[screen][pos+1] |= (image[1]&gt;&gt;temp);
00352    PA_Draw1632[screen][pos+2] |= (image[2]&gt;&gt;temp);
00353    PA_Draw1632[screen][pos+3] |= (image[3]&gt;&gt;temp);
00354    PA_Draw1632[screen][pos+4] |= (image[4]&gt;&gt;temp);   
00355    PA_Draw1632[screen][pos+5] |= (image[5]&gt;&gt;temp);
00356    PA_Draw1632[screen][pos+6] |= (image[6]&gt;&gt;temp);
00357    PA_Draw1632[screen][pos+7] |= (image[7]&gt;&gt;temp);      
00358 }  
00359 
00360 
00361 
00362 ALWAYSINLINE <span class="keywordtype">void</span> PA_16c16X8(u8 screen, s16 x, s16 y, u32 *image){  
00363    x += 8; y += 8;
00364    u16 temp = (x&amp;7)&lt;&lt;2;
00365    u16 pos = PA_16cPos(x, y);
00366    u8 i;
00367    <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++){
00368           PA_Plot8Pixels(screen, pos, temp, image[0]);
00369           PA_Plot8Pixels(screen, pos+1, temp, image[1]);  
00370           PA_Plot8Pixels(screen, pos+2, temp, image[2]);   
00371           PA_Plot8Pixels(screen, pos+3, temp, image[3]); 
00372           PA_Plot8Pixels(screen, pos+4, temp, image[4]);
00373           PA_Plot8Pixels(screen, pos+5, temp, image[5]);  
00374           PA_Plot8Pixels(screen, pos+6, temp, image[6]);   
00375           PA_Plot8Pixels(screen, pos+7, temp, image[7]);       
00376           pos+=26*8;
00377           image+=8;     
00378        }
00379 } 
00380 
00381 
00382 
00383 ALWAYSINLINE <span class="keywordtype">void</span> PA_16c16X12(u8 screen, s16 x, s16 y, u32 *image){  
00384    
00385    x += 8; y += 8;
00386    u16 temp = (x&amp;7)&lt;&lt;2;
00387    u16 pos = PA_16cPos(x, y);
00388    u8 i;
00389    <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++){
00390           PA_Plot8Pixels(screen, pos, temp, image[0]);
00391           PA_Plot8Pixels(screen, pos+1, temp, image[1]);  
00392           PA_Plot8Pixels(screen, pos+2, temp, image[2]);   
00393           PA_Plot8Pixels(screen, pos+3, temp, image[3]); 
00394           PA_Plot8Pixels(screen, pos+4, temp, image[4]);
00395           PA_Plot8Pixels(screen, pos+5, temp, image[5]);  
00396           PA_Plot8Pixels(screen, pos+6, temp, image[6]);   
00397           PA_Plot8Pixels(screen, pos+7, temp, image[7]);       
00398           PA_Plot8Pixels(screen, pos+8, temp, image[16]);
00399           PA_Plot8Pixels(screen, pos+9, temp, image[17]);  
00400           PA_Plot8Pixels(screen, pos+10, temp, image[18]);   
00401           PA_Plot8Pixels(screen, pos+11, temp, image[19]);        
00402           pos+=26*8;
00403           image+=8;     
00404        }
00405 } 
00406 
00407 ALWAYSINLINE <span class="keywordtype">void</span> PA_16c16X16(u8 screen, s16 x, s16 y, u32 *image){  
00408    
00409    x += 8; y += 8;
00410 
00411    u16 temp = (x&amp;7)&lt;&lt;2;
00412    u16 pos = PA_16cPos(x, y);
00413    u8 i;
00414    <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++){
00415           PA_Plot8Pixels(screen, pos, temp, image[0]);
00416           PA_Plot8Pixels(screen, pos+1, temp, image[1]);  
00417           PA_Plot8Pixels(screen, pos+2, temp, image[2]);   
00418           PA_Plot8Pixels(screen, pos+3, temp, image[3]); 
00419           PA_Plot8Pixels(screen, pos+4, temp, image[4]);
00420           PA_Plot8Pixels(screen, pos+5, temp, image[5]);  
00421           PA_Plot8Pixels(screen, pos+6, temp, image[6]);   
00422           PA_Plot8Pixels(screen, pos+7, temp, image[7]);       
00423           PA_Plot8Pixels(screen, pos+8, temp, image[16]);
00424           PA_Plot8Pixels(screen, pos+9, temp, image[17]);  
00425           PA_Plot8Pixels(screen, pos+10, temp, image[18]);   
00426           PA_Plot8Pixels(screen, pos+11, temp, image[19]); 
00427           PA_Plot8Pixels(screen, pos+12, temp, image[20]);
00428           PA_Plot8Pixels(screen, pos+13, temp, image[21]);  
00429           PA_Plot8Pixels(screen, pos+14, temp, image[22]);   
00430           PA_Plot8Pixels(screen, pos+15, temp, image[23]);               
00431           pos+=26*8;
00432           image+=8;     
00433        }
00434 }  
00435 
00436 
<a name="l00457"></a><a class="code" href="group__c.html#ga13">00457</a> ALWAYSINLINE <span class="keywordtype">void</span> <a class="code" href="group__c.html#ga13">PA_16c8Xi</a>(u8 screen, s16 x, s16 y, u32 *image, u8 i)
00458 {  
00459        x += 8; y += 8;
00460        u16 temp = ((x)&amp;7)&lt;&lt;2;
00461        u16 temp2 = 32-temp;
00462        u16 pos = PA_16cPos(x, y);
00463        u16 pos2 = pos + 208; <span class="comment">// Next columns</span>
00464        u8 j=0;
00465        <span class="keywordflow">while</span> (j&lt;i)
00466        {
00467               PA_Draw1632[screen][pos++] |= (image[j &amp; 0x000F]&lt;&lt;temp);
00468               PA_Draw1632[screen][pos2++] |= (image[j &amp; 0x000F]&gt;&gt;temp2);
00469               ++j;
00470        }
00471 }  
00472 
00473 
00474 
00475 
00476 
00477 <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> PA_16cLetter(u8 screen, s16 x, s16 y, <span class="keywordtype">char</span> letter, u8 size, u8 color){
00478        <span class="keywordflow">if</span> (c16policeheight[size]&lt;=8) PA_16c8X8Letter(screen, x, y, letter, size, color);
00479        <span class="comment">//(u32*)(c16_font[size]+(letter&lt;&lt;3))</span>
00480        <span class="keywordflow">else</span> PA_16c16X16Letter(screen, x, y, letter, size, color);
00481        <span class="comment">//(u32*)(c16_font[size]+(letter&lt;&lt;5))</span>
00482 }
00483 
00484 
00505 <span class="keywordtype">void</span> <a class="code" href="group__c.html#ga15">PA_16cClearZone</a>(u8 screen, s16 x1, s16 y1, s16 x2, s16 y2);
00506 
00507 
00508 
<a name="l00523"></a><a class="code" href="group__c.html#ga16">00523</a> <span class="keyword">extern</span> <span class="keyword">inline</span> u8 <a class="code" href="group__c.html#ga16">PA_16cGetPixel</a>(u8 screen, s16 x, s16 y){
00524        x += 8; y += 8;
00525    u16 temp = (x&amp;7)&lt;&lt;2;
00526    u16 pos = PA_16cPos(x, y);
00527    <span class="keywordflow">return</span> (PA_Draw1632[screen][pos]&amp;(15&lt;&lt;temp))&gt;&gt;temp;
00528 }
00529 
00530 
00531 
00532  <span class="comment">// end of 16c</span>
00534 
00535 
00536 
00537 
00538 <span class="preprocessor">#ifdef __cplusplus</span>
00539 <span class="preprocessor"></span>}
00540 <span class="preprocessor">#endif</span>
00541 <span class="preprocessor"></span>
00542 
00543 
00544 
00545 
00546 
00547 
00548 
00549 <span class="preprocessor">#endif</span>
00550 <span class="preprocessor"></span>
00551 
00552 
00553 
</pre></div><hr size="1"><address style="align: right;"><small>Généré le Tue Jan 30 23:10:49 2007 pour PAlib par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
