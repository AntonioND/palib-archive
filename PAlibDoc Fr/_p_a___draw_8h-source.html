<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PAlib:  Fichier source de PA_Draw.h</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Généré par Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Page&nbsp;principale</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">Liste&nbsp;des&nbsp;fichiers</a> | <a class="qindex" href="globals.html">Portée&nbsp;globale</a>  | <span class="search">Rechercher&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>PA_Draw.h</h1><a href="_p_a___draw_8h.html">Aller à la documentation de ce fichier.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef _PA_Buffer</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define _PA_Buffer</span>
00003 <span class="preprocessor"></span>
00004 <span class="preprocessor">#ifdef __cplusplus</span>
00005 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00006 <span class="preprocessor">#endif</span>
00007 <span class="preprocessor"></span>
00014 <span class="preprocessor">#include "PA9.h"</span>
00015 
00016 <span class="preprocessor">#include "<a class="code" href="_p_a___interrupt_8h.html">PA_Interrupt.h</a>"</span>
00017 <span class="preprocessor">#include "<a class="code" href="_p_a___palette_8h.html">PA_Palette.h</a>"</span>
00018 <span class="preprocessor">#include "<a class="code" href="_p_a___splash_8h.html">PA_Splash.h</a>"</span>
00019 <span class="preprocessor">#include "<a class="code" href="_p_a___gif_8h.html">PA_Gif.h</a>"</span>
00020 
00021 <span class="keyword">extern</span> u8 PA_nBit[2]; <span class="comment">// 8 or 16 bit Bg</span>
00022 
00023 <span class="keyword">extern</span> u16 tempvar;
00024 
00025 
00026 <span class="preprocessor">#define PA_RGB8(r,g,b)      ((((b)&gt;&gt;3)&lt;&lt;10)|(((g)&gt;&gt;3)&lt;&lt;5)|((r)&gt;&gt;3)|(1 &lt;&lt; 15))</span>
00027 <span class="preprocessor"></span>
00028 
00029 <span class="keyword">typedef</span> <span class="keyword">struct</span>{
00030        u16 Id; <span class="comment">// ?</span>
00031        u32 Length;
00032        u16 Nothing1, Nothing2; <span class="comment">// ?</span>
00033        u32 ImageStart; <span class="comment">// Offset of start of image</span>
00034 } BMPHeader0;
00035 
00036 <span class="keyword">typedef</span> <span class="keyword">struct</span>{
00037        u32 SizeofHeader; <span class="comment">// 40</span>
00038        u32 Width, Height;
00039        u16 Colorplanes; <span class="comment">// Usually 1</span>
00040        u16 BitsperPixel; <span class="comment">//1, 2, 4, 8, 16, 24, 32</span>
00041        u32 Compression;  <span class="comment">// 0 for none, 1...</span>
00042        u32 SizeofData; <span class="comment">// Not reliable</span>
00043        u32 WidthperMeter, HeightperMeter; <span class="comment">// Don't care</span>
00044        u32 NColors, ImportantColors; <span class="comment">// Number of colors used, important colors ?</span>
00045 } BMP_Headers;
00046 
00047 
00048 <span class="keyword">extern</span> u16 PA_oldx[2];
00049 <span class="keyword">extern</span> u16 PA_oldy[2];
00050 <span class="keyword">extern</span> u8 PA_drawsize[2];
00051 <span class="keyword">extern</span> u16 *PA_DrawBg[2];
00052 <span class="keyword">extern</span> u32 *PA_DrawBg32[2];
00053 <span class="keyword">extern</span> u8 PA_nBit[2]; <span class="comment">// 8 or 16 bit Bg</span>
00054 <span class="comment">//extern PA_SCreen</span>
00055 
00056 <span class="keyword">extern</span> u16 PA_temppal[256];
00057 <span class="comment">//extern s32 PA_GifSpeed;</span>
00058 
00059 
00060 
00078 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga0">PA_Init8bitBg</a>(u8 screen, u8 bg_priority);
00079 
00080 
00081 
00093 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga1">PA_InitBig8bitBg</a>(u8 screen, u8 bg_priority);
00094 
00095 
00107 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga2">PA_Init16bitBg</a>(u8 screen, u8 bg_priority);
00108 
00109 
00110 
<a name="l00128"></a><a class="code" href="group___bitmap.html#ga3">00128</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga3">PA_Put8bitPixel</a>(u8 screen, s16 x, s16 y, u8 color) {
00129    PA_DrawBg[screen][(y &lt;&lt;7) + (x&gt;&gt;1)] &amp;= (0xff00&gt;&gt;((x&amp;1)&lt;&lt;3));
00130    PA_DrawBg[screen][(y &lt;&lt;7) + (x&gt;&gt;1)] |= color&lt;&lt;((x&amp;1)&lt;&lt;3);
00131 
00132        <span class="comment">//s32 pos = (x &gt;&gt; 1) + (y &lt;&lt; 7);</span>
00133        <span class="comment">//u16 pixel = PA_DrawBg[screen][pos];</span>
00134        <span class="comment">//PA_DrawBg[screen][pos] = (color &lt;&lt; ((x&amp;1)&lt;&lt;3)) | (pixel&amp;(0xFF00&gt;&gt;((x&amp;1)&lt;&lt;3)));</span>
00135        <span class="comment">/*if (x&amp;1){</span>
00136 <span class="comment">              PA_DrawBg[screen][pos] = (color &lt;&lt; 8) | (pixel&amp;0x00FF);               </span>
00137 <span class="comment">       }</span>
00138 <span class="comment">       else {</span>
00139 <span class="comment">              PA_DrawBg[screen][pos] = color | (pixel&amp;0xFF00); </span>
00140 <span class="comment">       }*/</span>
00141 }
00142 
00143 
00144 
<a name="l00163"></a><a class="code" href="group___bitmap.html#ga4">00163</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga4">PA_Put2_8bitPixels</a>(u8 screen, s16 x, s16 y, u16 colors) {        PA_DrawBg[screen][(x &gt;&gt; 1) + (y &lt;&lt; 7)] = colors;
00164 }
00165 
<a name="l00186"></a><a class="code" href="group___bitmap.html#ga5">00186</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga5">PA_PutDouble8bitPixels</a>(u8 screen, s16 x, s16 y, u8 color1, u8 color2) {
00187        <a class="code" href="group___bitmap.html#ga4">PA_Put2_8bitPixels</a>(screen, x, y, color1 + (color2 &lt;&lt; 8));             
00188 }
00189 
00190 
00191 
<a name="l00210"></a><a class="code" href="group___bitmap.html#ga6">00210</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga6">PA_Put4_8bitPixels</a>(u8 screen, s16 x, s16 y, u32 colors) {
00211 
00212        PA_DrawBg32[screen][(x &gt;&gt; 2) + (y &lt;&lt; 6)] = colors;
00213 }
00214 
00215 
<a name="l00230"></a><a class="code" href="group___bitmap.html#ga7">00230</a> <span class="keyword">extern</span> <span class="keyword">inline</span> u8 <a class="code" href="group___bitmap.html#ga7">PA_Get8bitPixel</a>(u8 screen, u8 x, u8 y) {
00231        u16 pos =     (x &gt;&gt; 1) + (y &lt;&lt; 7);
00232        <span class="keywordflow">if</span> (x&amp;1){
00233               <span class="keywordflow">return</span> (PA_DrawBg[screen][pos] &gt;&gt; 8);
00234        }
00235        <span class="keywordflow">else</span> {
00236               <span class="keywordflow">return</span> (PA_DrawBg[screen][pos]);
00237        }
00238 }
00239 
00240 
00241 
00242 
<a name="l00260"></a><a class="code" href="group___bitmap.html#ga8">00260</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga8">PA_Put16bitPixel</a>(u8 screen, s16 x, s16 y, u16 color) {
00261        PA_DrawBg[screen][x + (y &lt;&lt; 8)] = color;
00262 }
00263 
00264 
<a name="l00279"></a><a class="code" href="group___bitmap.html#ga24">00279</a> <span class="preprocessor">#define PA_Get16bitPixel(screen, x, y) PA_DrawBg[screen][(x) + ((y) &lt;&lt; 8)]</span>
00280 <span class="preprocessor"></span>
00281 
00282 
00283 
00284 
00285 
00309 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga9">PA_Draw8bitLine</a>(u8 screen, u16 x1, u16 y1, u16 x2, u16 y2, u8 color);
00310 
00311 
00312 
00313 
00314 
00338 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga10">PA_Draw16bitLine</a>(u8 screen, u16 x1, u16 y1, u16 x2, u16 y2, u16 color);
00339 
00340 
00341 
00368 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga11">PA_Draw16bitLineEx</a>(u8 screen, s16 basex, s16 basey, s16 endx, s16 endy, u16 color, s8 size);
00369 
00370 
00397 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga12">PA_Draw8bitLineEx</a>(u8 screen, s16 basex, s16 basey, s16 endx, s16 endy, u8 color, s8 size);
00398 
00399 
00400 
00424 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga13">PA_Draw16bitRect</a>(u8 screen, s16 basex, s16 basey, s16 endx, s16 endy, u16 color);
00425 
00426 
00438 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga14">PA_8bitDraw</a>(u8 screen, u8 color);
00439 
00440 
00452 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga15">PA_16bitDraw</a>(u8 screen, u16 color);
00453 
00454 
<a name="l00466"></a><a class="code" href="group___bitmap.html#ga25">00466</a> <span class="preprocessor">#define PA_SetDrawSize(screen, draw_size) PA_drawsize[screen] = draw_size;</span>
00467 <span class="preprocessor"></span>
00468 
00469 
00470 
00471 
<a name="l00483"></a><a class="code" href="group___bitmap.html#ga26">00483</a> <span class="preprocessor">#define PA_Load8bitBitmap(screen, bitmap) DMA_Copy(bitmap, (void*)PA_DrawBg[screen], 256*96, DMA_16NOW)</span>
00484 <span class="preprocessor"></span>
<a name="l00496"></a><a class="code" href="group___bitmap.html#ga27">00496</a> <span class="preprocessor">#define PA_Load16bitBitmap(screen, bitmap) {u32 PA_temp; \</span>
00497 <span class="preprocessor">for (PA_temp = 0; PA_temp &lt; 256*192; PA_temp++)\</span>
00498 <span class="preprocessor">PA_DrawBg[screen][PA_temp] = bitmap[PA_temp] | (1 &lt;&lt; 15);}</span>
00499 <span class="preprocessor"></span>
00500 
<a name="l00509"></a><a class="code" href="group___bitmap.html#ga28">00509</a> <span class="preprocessor">#define PA_Clear8bitBg(screen) DMA_Copy(Blank, (void*)PA_DrawBg[screen], 256*96, DMA_16NOW);</span>
00510 <span class="preprocessor"></span>
<a name="l00519"></a><a class="code" href="group___bitmap.html#ga29">00519</a> <span class="preprocessor">#define PA_Clear16bitBg(screen) DMA_Copy(Blank, (void*)PA_DrawBg[screen], 256*192, DMA_16NOW)</span>
00520 <span class="preprocessor"></span>
00521 
<a name="l00533"></a><a class="code" href="group___bitmap.html#ga16">00533</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga16">PA_LoadJpeg</a>(u8 screen, <span class="keywordtype">void</span> *jpeg) {
00534        REG_IME = 0x00;
00535        JPEG_DecompressImage((u8*)jpeg, PA_DrawBg[screen], 256, 192);
00536        REG_IME = 0x01;      
00537 }
00538 
00539 
00540 
00561 <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga17">PA_LoadBmpToBuffer</a>(u16 *Buffer, s16 x, s16 y, <span class="keywordtype">void</span> *bmp, s16 SWidth);
00562 
00563 
<a name="l00581"></a><a class="code" href="group___bitmap.html#ga18">00581</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga18">PA_LoadBmpEx</a>(u8 screen, s16 x, s16 y, <span class="keywordtype">void</span> *bmp){
00582 <a class="code" href="group___bitmap.html#ga17">PA_LoadBmpToBuffer</a>(PA_DrawBg[screen], x, y, bmp, 256);
00583 }
00584 
00585 
00586 
<a name="l00598"></a><a class="code" href="group___bitmap.html#ga19">00598</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga19">PA_LoadBmp</a>(u8 screen, <span class="keywordtype">void</span> *bmp){
00599        <a class="code" href="group___bitmap.html#ga18">PA_LoadBmpEx</a>(screen, 0, 0, bmp);
00600 }
00601 
00602 
00603 
00604 
00605 
00606 
00607 <span class="comment">/* // Les différentes fonctions images...</span>
00608 <span class="comment">extern inline void PA_LoadJpeg(u8 screen, void *jpeg)</span>
00609 <span class="comment">void PA_LoadBmp(u8 screen, s16 x, s16 y, void *bmp);*/</span>
00610 
00611 
<a name="l00623"></a><a class="code" href="group___bitmap.html#ga20">00623</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___bitmap.html#ga20">PA_LoadFSImage</a>(u8 screen, s16 FSImage){
00624        <span class="keywordflow">if</span> (<a class="code" href="group___text.html#ga26">PA_CompareText</a>(PA_FSFile[FSImage].Ext, <span class="stringliteral">"bmp"</span>)){
00625               <a class="code" href="group___bitmap.html#ga19">PA_LoadBmp</a>(screen, <a class="code" href="group___p_a_f_s.html#ga8">PA_PAFSFile</a>(FSImage));
00626        }
00627        <span class="keywordflow">if</span> (<a class="code" href="group___text.html#ga26">PA_CompareText</a>(PA_FSFile[FSImage].Ext, <span class="stringliteral">"jpg"</span>)){ 
00628               <a class="code" href="group___bitmap.html#ga16">PA_LoadJpeg</a>(screen, <a class="code" href="group___p_a_f_s.html#ga8">PA_PAFSFile</a>(FSImage));
00629        }      
00630        <span class="keywordflow">if</span> (<a class="code" href="group___text.html#ga26">PA_CompareText</a>(PA_FSFile[FSImage].Ext, <span class="stringliteral">"gif"</span>)){ 
00631               <a class="code" href="group___gif.html#ga3">PA_LoadGif</a>(screen, <a class="code" href="group___p_a_f_s.html#ga8">PA_PAFSFile</a>(FSImage));
00632        }             
00633 }
00634 
00635 
00636 
00637 
00638 <span class="comment">/*</span>
00639 <span class="comment">extern inline void PA_LoadGBFSImage(u8 screen, s16 GBFSImage){</span>
00640 <span class="comment">       if (PA_CompareText(PA_GBFSfile[GBFSImage].Ext, "bmp")){</span>
00641 <span class="comment">              PA_LoadBmp(screen, PA_GBFSfile[GBFSImage].File);</span>
00642 <span class="comment">       }</span>
00643 <span class="comment">       if (PA_CompareText(PA_GBFSfile[GBFSImage].Ext, "jpg")){ </span>
00644 <span class="comment">              PA_LoadJpeg(screen, PA_GBFSfile[GBFSImage].File);</span>
00645 <span class="comment">       }      </span>
00646 <span class="comment">       if (PA_CompareText(PA_GBFSfile[GBFSImage].Ext, "gif")){ </span>
00647 <span class="comment">              PA_LoadGif(screen, PA_GBFSfile[GBFSImage].File);</span>
00648 <span class="comment">       }             </span>
00649 <span class="comment">}</span>
00650 <span class="comment">*/</span>
00651 <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> PA_LoadGBFSImageToBuffer(<span class="keywordtype">void</span> *Buffer, s16 GBFSImage, s16 Width){
00652        <span class="keywordflow">if</span> (<a class="code" href="group___text.html#ga26">PA_CompareText</a>(PA_GBFSfile[GBFSImage].Ext, <span class="stringliteral">"bmp"</span>)){
00653               <a class="code" href="group___bitmap.html#ga17">PA_LoadBmpToBuffer</a>((u16*)Buffer, 0, 0, (u16*)PA_GBFSfile[GBFSImage].File, Width);
00654        }
00655        <span class="comment">/*if (PA_CompareText(PA_GBFSfile[GBFSImage].Ext, "jpg")){ </span>
00656 <span class="comment">              PA_LoadJpeg(screen, PA_GBFSfile[GBFSImage].File);</span>
00657 <span class="comment">       }      */</span>
00658        <span class="keywordflow">if</span> (<a class="code" href="group___text.html#ga26">PA_CompareText</a>(PA_GBFSfile[GBFSImage].Ext, <span class="stringliteral">"gif"</span>)){ 
00659               DecodeGif((<span class="keyword">const</span> u8*)PA_GBFSfile[GBFSImage].File, (u8*)Buffer, (u16*)0x05000000, 1, Width);
00660        }             
00661 }
00662 
00663 
00664 
<a name="l00673"></a><a class="code" href="group___bitmap.html#ga22">00673</a> <span class="keyword">extern</span> <span class="keyword">inline</span> u16 <a class="code" href="group___bitmap.html#ga22">PA_GetBmpWidth</a>(<span class="keywordtype">void</span> *bmp){
00674        u8 *temp = (u8*)bmp;
00675        BMP_Headers *Bmpinfo = (BMP_Headers*)(temp+14);
00676        <span class="keywordflow">return</span> Bmpinfo-&gt;Width;
00677 }
00678 
00679 
00680 
<a name="l00689"></a><a class="code" href="group___bitmap.html#ga23">00689</a> <span class="keyword">extern</span> <span class="keyword">inline</span> u16 <a class="code" href="group___bitmap.html#ga23">PA_GetBmpHeight</a>(<span class="keywordtype">void</span> *bmp){
00690        u8 *temp = (u8*)bmp;
00691        BMP_Headers *Bmpinfo = (BMP_Headers*)(temp+14);
00692        <span class="keywordflow">return</span> Bmpinfo-&gt;Height;
00693 } <span class="comment">// end of Draw</span>
00695 
00696 
00697 <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> PA_8bit8x8Image(u8 screen, u16 basex, u16 basey, u8* data){
00698 s16 x, y;
00699 
00700 <span class="keywordflow">for</span> (x = 0; x &lt; 8; x++)
00701        <span class="keywordflow">for</span> (y = 0; y &lt; 8; y++)
00702               <a class="code" href="group___bitmap.html#ga3">PA_Put8bitPixel</a>(screen, x + basex, y + basey, data[x + (y &lt;&lt; 3)]);
00703 }
00704 
00705 <span class="comment">/*</span>
00706 <span class="comment">extern inline void PA_DrawImage(u8 screen, s16 x, s16 y, s16 lx, s16 ly, u8* data){</span>
00707 <span class="comment">s16 i, j;</span>
00708 <span class="comment">u16* data2 = (u16*)data;</span>
00709 <span class="comment"></span>
00710 <span class="comment">if (x&amp;1){ // Premier pixel à mettre tout seul peut-etre</span>
00711 <span class="comment">       for (j = 0; j &lt; ly; j++) PA_Put8bitPixel(screen, x, j + y, data[0]);</span>
00712 <span class="comment">       x++;</span>
00713 <span class="comment">       data2 = (u16*)(data + 1);</span>
00714 <span class="comment">}</span>
00715 <span class="comment"></span>
00716 <span class="comment">i = 0;</span>
00717 <span class="comment">// Tant qu'il reste au moins 2 pixels à mettre, on fait 2 par 2</span>
00718 <span class="comment">while(i &lt; (lx-2)){</span>
00719 <span class="comment">       for (j = 0; j &lt; ly; j++) {</span>
00720 <span class="comment">              PA_PutDouble8bitPixels(screen, i + x, j + y, data2[(i &gt;&gt; 1) + (j*lx)]);</span>
00721 <span class="comment">       }</span>
00722 <span class="comment">       i+=2;</span>
00723 <span class="comment">}</span>
00724 <span class="comment"></span>
00725 <span class="comment">if (!((i + x)&amp;1)){ // Dernier pixel à mettre tout seul peut-etre</span>
00726 <span class="comment">       for (j = 0; j &lt; ly; j++) PA_Put8bitPixel(screen, i + x, j + y, data2[(i &gt;&gt; 1) + (j*lx)]&amp;255);</span>
00727 <span class="comment">}</span>
00728 <span class="comment"></span>
00729 <span class="comment">}</span>
00730 <span class="comment">*/</span>
00731 
00732 
00733 
00734 
00735 <span class="comment">/*</span>
00744 <span class="comment">extern inline void PA_SetGifSpeed(s32 NVBLs){</span>
00745 <span class="comment">       PA_GifSpeed = NVBLs;</span>
00746 <span class="comment">}*/</span>
00747 
00748 
00749 
00750 
00751 <span class="preprocessor">#ifdef __cplusplus</span>
00752 <span class="preprocessor"></span>}
00753 <span class="preprocessor">#endif</span>
00754 <span class="preprocessor"></span>
00755 
00756 
00757 
00758 
00759 
00760 
00761 
00762 <span class="preprocessor">#endif</span>
00763 <span class="preprocessor"></span>
00764 
</pre></div><hr size="1"><address style="align: right;"><small>Généré le Tue Jan 30 23:10:49 2007 pour PAlib par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
