<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PAlib:  Fichier source de PA_Sound.h</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Généré par Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Page&nbsp;principale</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">Liste&nbsp;des&nbsp;fichiers</a> | <a class="qindex" href="globals.html">Portée&nbsp;globale</a>  | <span class="search">Rechercher&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>PA_Sound.h</h1><a href="_p_a___sound_8h.html">Aller à la documentation de ce fichier.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef _PA_Sound9</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define _PA_Sound9</span>
00003 <span class="preprocessor"></span>
00004 
00005 
00013 <span class="preprocessor">#include "../Sound9.h"</span>
00014 <span class="preprocessor">#include "<a class="code" href="_p_a___g_b_f_s_8h.html">PA_GBFS.h</a>"</span>
00015 <span class="preprocessor">#include "<a class="code" href="_p_a___f_s_8h.html">PA_FS.h</a>"</span>
00016 <span class="preprocessor">#include &lt;PA9.h&gt;</span>
00017 
00018        <span class="comment">// 256KB to load MOD files into. Actual size necessary is the size </span>
00019        <span class="comment">// of your largest MOD file (probably less than 256KB).</span>
00020 <span class="preprocessor">#define SND_MEM_POOL_SIZE   256*1024</span>
00021 <span class="preprocessor"></span>
00022 
00023 
00024 <span class="keyword">extern</span> TransferSound snd;
00025 <span class="keyword">extern</span> u32 *sndMemPool;
00026 
00027 <span class="keyword">typedef</span> <span class="keyword">struct</span>{ <span class="comment">// Default sound format</span>
00028        u8 volume;
00029        s16 freq;
00030        s16 format;
00031 } PA_SoundOptions;
00032 
00033 <span class="keyword">extern</span> PA_SoundOptions PA_SoundOption;
00034 
00035 <span class="keyword">extern</span> u32 *FS_mod;
00036 <span class="keyword">extern</span> u32 *FS_wav[16]; <span class="comment">// 16 channels...</span>
00037 
00038 
00039 
00040 <span class="comment">//Stream vars</span>
00041 <span class="keyword">extern</span> u32 *Stream_Gap[16];
00042 <span class="keyword">extern</span> u32 *Stream_End[16];
00043 <span class="keyword">extern</span> u32 *Stream_Datas[16]; 
00044 <span class="keyword">extern</span> u32 *Stream_Regen_Ptr[16];
00045 <span class="keyword">extern</span> s64    Stream_Length[16];
00046 <span class="keyword">extern</span> u32    Stream_Last_Tick[16];
00047 <span class="keyword">extern</span> s32    Stream_Repeat[16];
00048 <span class="keyword">extern</span> u8     Stream_Timer[16];
00049 
00050 <span class="comment">//plays an 8 bit mono sample at 11025Hz</span>
00051 
00052 
00053 
00054 
00055 
00056 
00077 <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga0">PA_SetDefaultSound</a>(u8 volume, <span class="keywordtype">int</span> freq, s16 format);
00078 
00079 
<a name="l00085"></a><a class="code" href="group___sound_a_r_m9.html#ga1">00085</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga1">PA_InitSound</a>(<span class="keywordtype">void</span>) {
00086        SndInit9 ();
00087        sndMemPool = (u32*)0x2200000;
00088        SndSetMemPool(sndMemPool, SND_MEM_POOL_SIZE);
00089        <a class="code" href="group___sound_a_r_m9.html#ga0">PA_SetDefaultSound</a>(127, 11025, 0);
00090        FS_mod = NULL; <span class="comment">// Initialise a small portion of memory, will make it bigger later on...</span>
00091        u8 i;
00092        <span class="keywordflow">for</span> (i = 0; i &lt; 16; i++)
00093        {
00094               FS_wav[i] = NULL; <span class="comment">// to be able to free</span>
00095        }
00096 
00097 }
00098 
00104 <span class="keyword">extern</span> <span class="keywordtype">void</span> PA_InitStreamSound(<span class="keywordtype">void</span>);
00105 
00111 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga3">PA_RegenStream</a>(<span class="keywordtype">void</span>);
00112 
00118 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga4">FillTheGap</a>(u8 PA_Channel, u32 size);
00119 
00149 <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga5">PA_PlaySoundEx2</a>(u8 PA_Channel, <span class="keyword">const</span> <span class="keywordtype">void</span>* data, s32 length, u8 volume, <span class="keywordtype">int</span> freq, s16 format, BOOL repeat, <span class="keywordtype">int</span> repeatPoint);
00150 
<a name="l00174"></a><a class="code" href="group___sound_a_r_m9.html#ga6">00174</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga6">PA_PlaySoundEx</a>(u8 PA_Channel, <span class="keyword">const</span> <span class="keywordtype">void</span>* data, s32 length, u8 volume, <span class="keywordtype">int</span> freq, s16 format){
00175 <a class="code" href="group___sound_a_r_m9.html#ga5">PA_PlaySoundEx2</a>(PA_Channel, data, length, volume, freq, format,<span class="keyword">false</span>,0);
00176 }
00177 
<a name="l00198"></a><a class="code" href="group___sound_a_r_m9.html#ga7">00198</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga7">PA_PlayGBFSSoundEx</a>(u8 PA_Channel, u16 FS_wav_number, u8 volume, <span class="keywordtype">int</span> freq, s16 format){
00199 s32 length = (PA_GBFSfile[FS_wav_number].Length &gt;&gt; 2) + 1; <span class="comment">// Pour etre sur...</span>
00200        free(FS_wav[PA_Channel]);
00201        FS_wav[PA_Channel] = (u32*)malloc(length &lt;&lt; 2);
00202        
00203        DMA_Copy(PA_GBFSfile[FS_wav_number].File, FS_wav[PA_Channel], length, DMA_32NOW);
00204 
00205        <a class="code" href="group___sound_a_r_m9.html#ga6">PA_PlaySoundEx</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, volume, freq, format);
00206 }
00207 
<a name="l00234"></a><a class="code" href="group___sound_a_r_m9.html#ga8">00234</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga8">PA_PlayGBFSSoundEx2</a>(u8 PA_Channel, u16 FS_wav_number, u8 volume, <span class="keywordtype">int</span> freq, s16 format, BOOL repeat, <span class="keywordtype">int</span> repeatPoint){
00235 s32 length = (PA_GBFSfile[FS_wav_number].Length &gt;&gt; 2) + 1; <span class="comment">// Pour etre sur...</span>
00236        free(FS_wav[PA_Channel]);
00237        FS_wav[PA_Channel] = (u32*)malloc(length &lt;&lt; 2);
00238        
00239        DMA_Copy(PA_GBFSfile[FS_wav_number].File, FS_wav[PA_Channel], length, DMA_32NOW);
00240 
00241        <a class="code" href="group___sound_a_r_m9.html#ga5">PA_PlaySoundEx2</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, volume, freq, format, repeat, repeatPoint);
00242 
00243 }
00244 
00271 <span class="keywordtype">void</span> PA_PlayGBFSStreamSoundEx2(u8 PA_Channel, u16 FS_wav_number, u8 volume, <span class="keywordtype">int</span> freq, s16 format, BOOL repeat, <span class="keywordtype">int</span> repeatPoint);
00272 
00273 
<a name="l00294"></a><a class="code" href="group___sound_a_r_m9.html#ga10">00294</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga10">PA_PlayFSSoundEx</a>(u8 PA_Channel, u16 PAFS_wav_number, u8 volume, <span class="keywordtype">int</span> freq, s16 format){
00295        <a class="code" href="group___p_a_f_s.html#ga4">PA_Malloc</a>((<span class="keywordtype">void</span>**)FS_wav[PA_Channel], PA_FSFile[PAFS_wav_number].Length+4);
00296 
00297        s32 i;
00298        s32 length = (PA_FSFile[PAFS_wav_number].Length&gt;&gt;2) + 1; <span class="comment">// Pour etre sur...</span>
00299        <span class="keywordflow">for</span> (i = 0; i &lt; length; i++) FS_wav[PA_Channel][i] = ((u32*)<a class="code" href="group___p_a_f_s.html#ga5">PA_PAFSFile</a>(PAFS_wav_number))[i];
00300        
00301        <a class="code" href="group___sound_a_r_m9.html#ga6">PA_PlaySoundEx</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, volume, freq, format);
00302 }
00303 
<a name="l00330"></a><a class="code" href="group___sound_a_r_m9.html#ga11">00330</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga11">PA_PlayFSSoundEx2</a>(u8 PA_Channel, u16 PAFS_wav_number, u8 volume, <span class="keywordtype">int</span> freq, s16 format, BOOL repeat, <span class="keywordtype">int</span> repeatPoint){
00331        <a class="code" href="group___p_a_f_s.html#ga4">PA_Malloc</a>((<span class="keywordtype">void</span>**)FS_wav[PA_Channel], PA_FSFile[PAFS_wav_number].Length+4);
00332 
00333        s32 i;
00334        s32 length = (PA_FSFile[PAFS_wav_number].Length&gt;&gt;2) + 1; <span class="comment">// Pour etre sur...</span>
00335        <span class="keywordflow">for</span> (i = 0; i &lt; length; i++) FS_wav[PA_Channel][i] = ((u32*)<a class="code" href="group___p_a_f_s.html#ga5">PA_PAFSFile</a>(PAFS_wav_number))[i];
00336        
00337        <a class="code" href="group___sound_a_r_m9.html#ga5">PA_PlaySoundEx2</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, volume, freq, format, repeat, repeatPoint);
00338 }
00339 
00366 <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga12">PA_PlayFSStreamSoundEx2</a>(u8 PA_Channel, u16 PAFS_wav_number, u8 volume, <span class="keywordtype">int</span> freq, s16 format, BOOL repeat, <span class="keywordtype">int</span> repeatPoint);
00367 
<a name="l00388"></a><a class="code" href="group___sound_a_r_m9.html#ga13">00388</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga13">PA_PlaySound</a>(u8 PA_Channel, <span class="keyword">const</span> <span class="keywordtype">void</span>* data, s32 length, u8 volume, u32 freq){
00389 <a class="code" href="group___sound_a_r_m9.html#ga5">PA_PlaySoundEx2</a>(PA_Channel, data, length, volume, freq, 1,<span class="keyword">false</span>,0);
00390 }
00391 
<a name="l00409"></a><a class="code" href="group___sound_a_r_m9.html#ga14">00409</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga14">PA_PlayGBFSSound</a>(u8 PA_Channel, u16 FS_wav_number, u8 volume, u32 freq){
00410 s32 length = (PA_GBFSfile[FS_wav_number].Length &gt;&gt; 2) + 1; <span class="comment">// Pour etre sur...</span>
00411        free(FS_wav[PA_Channel]);
00412        FS_wav[PA_Channel] = (u32*)malloc(length &lt;&lt; 2);
00413        
00414        DMA_Copy(PA_GBFSfile[FS_wav_number].File, FS_wav[PA_Channel], length, DMA_32NOW);
00415 
00416        <a class="code" href="group___sound_a_r_m9.html#ga13">PA_PlaySound</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, volume, freq);
00417 
00418        SndPlay(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, volume, freq, 0, <span class="keyword">false</span>, 0);
00419 }
00420 
00421 
<a name="l00439"></a><a class="code" href="group___sound_a_r_m9.html#ga15">00439</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga15">PA_PlayFSSound</a>(u8 PA_Channel, u16 PAFS_wav_number, u8 volume, u32 freq){
00440        <a class="code" href="group___p_a_f_s.html#ga4">PA_Malloc</a>((<span class="keywordtype">void</span>**)(FS_wav[PA_Channel]), PA_FSFile[PAFS_wav_number].Length+4);
00441 
00442        s32 i;
00443        s32 length = (PA_FSFile[PAFS_wav_number].Length&gt;&gt;2) + 1; <span class="comment">// Pour etre sur...</span>
00444        <span class="keywordflow">for</span> (i = 0; i &lt; length; i++) FS_wav[PA_Channel][i] = ((u32*)<a class="code" href="group___p_a_f_s.html#ga5">PA_PAFSFile</a>(PAFS_wav_number))[i];
00445        
00446        <a class="code" href="group___sound_a_r_m9.html#ga13">PA_PlaySound</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, volume, freq);
00447 }
00448 
00449 
00450 
<a name="l00463"></a><a class="code" href="group___sound_a_r_m9.html#ga24">00463</a> <span class="preprocessor">#define PA_PlaySimpleSound(PA_Channel, sound) PA_PlaySoundEx(PA_Channel, (void*)sound, (u32)sound##_size, PA_SoundOption.volume, PA_SoundOption.freq, PA_SoundOption.format)</span>
00464 <span class="preprocessor"></span>
00465 
<a name="l00477"></a><a class="code" href="group___sound_a_r_m9.html#ga16">00477</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga16">PA_PlayGBFSSimpleSound</a>(u8 PA_Channel, u16 FS_wav_number){
00478 s32 length = (PA_GBFSfile[FS_wav_number].Length &gt;&gt; 2) + 1; <span class="comment">// Pour etre sur...</span>
00479        free(FS_wav[PA_Channel]);
00480        FS_wav[PA_Channel] = (u32*)malloc(length &lt;&lt; 2);
00481        
00482        DMA_Copy(PA_GBFSfile[FS_wav_number].File, FS_wav[PA_Channel], length, DMA_32NOW);
00483 
00484        <a class="code" href="group___sound_a_r_m9.html#ga13">PA_PlaySound</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, PA_SoundOption.volume, PA_SoundOption.freq);
00485 }
00486 
00487 
00488 
00489 
<a name="l00501"></a><a class="code" href="group___sound_a_r_m9.html#ga17">00501</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga17">PA_PlayFSSimpleSound</a>(u8 PA_Channel, u16 PAFS_wav_number){
00502        <a class="code" href="group___p_a_f_s.html#ga4">PA_Malloc</a>((<span class="keywordtype">void</span>**)(FS_wav[PA_Channel]), PA_FSFile[PAFS_wav_number].Length+4);
00503 
00504        s32 i;
00505        s32 length = (PA_FSFile[PAFS_wav_number].Length&gt;&gt;2) + 1; <span class="comment">// Pour etre sur...</span>
00506        <span class="keywordflow">for</span> (i = 0; i &lt; length; i++) FS_wav[PA_Channel][i] = ((u32*)<a class="code" href="group___p_a_f_s.html#ga5">PA_PAFSFile</a>(PAFS_wav_number))[i];
00507        
00508        <a class="code" href="group___sound_a_r_m9.html#ga13">PA_PlaySound</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], PA_FSFile[PAFS_wav_number].Length, PA_SoundOption.volume, PA_SoundOption.freq);
00509 }
00510 
00511 
00512 
00513 
00514 
00515 
<a name="l00524"></a><a class="code" href="group___sound_a_r_m9.html#ga25">00524</a> <span class="preprocessor">#define PA_PlayMod(mod_snd) SndPlayMOD((u8*)mod_snd)</span>
00525 <span class="preprocessor"></span>
00526 
<a name="l00535"></a><a class="code" href="group___sound_a_r_m9.html#ga18">00535</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga18">PA_PlayGBFSMod</a>(u16 FS_mod_number){
00536 s32 length = (PA_GBFSfile[FS_mod_number].Length &gt;&gt; 2) + 1; <span class="comment">// Pour etre sur...</span>
00537        free(FS_mod);
00538        FS_mod = (u32*)malloc(length &lt;&lt; 2);
00539 
00540        DMA_Copy(PA_GBFSfile[FS_mod_number].File, FS_mod, length, DMA_32NOW);
00541 
00542        <a class="code" href="group___sound_a_r_m9.html#ga25">PA_PlayMod</a>(FS_mod);
00543 }
00544 
00545 
<a name="l00554"></a><a class="code" href="group___sound_a_r_m9.html#ga19">00554</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga19">PA_PlayFSMod</a>(u16 PAFS_mod_number){
00555        <a class="code" href="group___p_a_f_s.html#ga4">PA_Malloc</a>((<span class="keywordtype">void</span>**)((u32)(&amp;FS_mod)), PA_FSFile[PAFS_mod_number].Length+4);
00556 
00557        s32 i;
00558        s32 length = (PA_FSFile[PAFS_mod_number].Length&gt;&gt;2) + 1; <span class="comment">// Pour etre sur...</span>
00559        <span class="keywordflow">for</span> (i = 0; i &lt; length; i++) FS_mod[i] = ((u32*)<a class="code" href="group___p_a_f_s.html#ga5">PA_PAFSFile</a>(PAFS_mod_number))[i];
00560        
00561        <a class="code" href="group___sound_a_r_m9.html#ga25">PA_PlayMod</a>(FS_mod);
00562 }
00563 
00564 
00565 
<a name="l00571"></a><a class="code" href="group___sound_a_r_m9.html#ga26">00571</a> <span class="preprocessor">#define PA_StopMod() SndStopMOD()</span>
00572 <span class="preprocessor"></span>
00573 
<a name="l00582"></a><a class="code" href="group___sound_a_r_m9.html#ga27">00582</a> <span class="preprocessor">#define PA_PauseMod(u8) SndPauseMOD(u8)</span>
00583 <span class="preprocessor"></span>
00584 
00585 
00594 <span class="keywordtype">void</span> PA_StopStream(u8 PA_Channel);
00595 
00604 <span class="keywordtype">void</span> PA_PauseStream(u8 PA_Channel);
00605 
00614 <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga22">PA_UnpauseStream</a>(u8 PA_Channel);
00615 
00616 
<a name="l00628"></a><a class="code" href="group___sound_a_r_m9.html#ga23">00628</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga23">PA_MicStartRecording</a>(u8* buffer, <span class="keywordtype">int</span> length){StartRecording(buffer, length);}
00629 
<a name="l00635"></a><a class="code" href="group___sound_a_r_m9.html#ga28">00635</a> <span class="preprocessor">#define PA_MicStopRecording() StopRecording()</span>
00636 <span class="preprocessor"></span> <span class="comment">// end of SoundARM9</span>
00638 
00639 
00640 
00641 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Généré le Tue Sep 5 20:35:54 2006 pour PAlib par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
