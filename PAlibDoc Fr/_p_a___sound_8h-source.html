<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PAlib:  Fichier source de PA_Sound.h</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Généré par Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Page&nbsp;principale</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">Liste&nbsp;des&nbsp;fichiers</a> | <a class="qindex" href="globals.html">Portée&nbsp;globale</a>  | <span class="search">Rechercher&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>PA_Sound.h</h1><a href="_p_a___sound_8h.html">Aller à la documentation de ce fichier.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef _PA_Sound9</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define _PA_Sound9</span>
00003 <span class="preprocessor"></span>
00004 
00005 
00013 <span class="preprocessor">#include "../Sound9.h"</span>
00014 <span class="preprocessor">#include "<a class="code" href="_p_a___g_b_f_s_8h.html">PA_GBFS.h</a>"</span>
00015 <span class="preprocessor">#include "<a class="code" href="_p_a___f_s_8h.html">PA_FS.h</a>"</span>
00016 <span class="preprocessor">#include &lt;<a class="code" href="_p_a9_8h.html">PA9.h</a>&gt;</span>
00017 
00018        <span class="comment">// 256KB to load MOD files into. Actual size necessary is the size </span>
00019        <span class="comment">// of your largest MOD file (probably less than 256KB).</span>
00020 <span class="preprocessor">#define SND_MEM_POOL_SIZE   256*1024</span>
00021 <span class="preprocessor"></span>
00022 
00023 
00024 <span class="keyword">extern</span> TransferSound snd;
00025 <span class="keyword">extern</span> u32 *sndMemPool;
00026 
00027 <span class="keyword">typedef</span> <span class="keyword">struct</span>{ <span class="comment">// Default sound format</span>
00028        u8 volume;
00029        s32 freq;
00030        s16 format;
00031 } PA_SoundOptions;
00032 
00033 <span class="keyword">extern</span> PA_SoundOptions PA_SoundOption;
00034 
00035 <span class="keyword">extern</span> u32 *FS_mod;
00036 <span class="keyword">extern</span> u32 *FS_wav[16]; <span class="comment">// 16 channels...</span>
00037 
00038 <span class="comment">//plays an 8 bit mono sample at 11025Hz</span>
00039 
00040 
00041 
00042 
00043 
00044 
00065 <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga0">PA_SetDefaultSound</a>(u8 volume, s32 freq, s16 format);
00066 
00067 
<a name="l00073"></a><a class="code" href="group___sound_a_r_m9.html#ga1">00073</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga1">PA_InitSound</a>(<span class="keywordtype">void</span>) {
00074        SndInit9 ();
00075        sndMemPool = (u32*)0x2200000;
00076        SndSetMemPool(sndMemPool, SND_MEM_POOL_SIZE);
00077        <a class="code" href="group___sound_a_r_m9.html#ga0">PA_SetDefaultSound</a>(127, 11025, 0);
00078        FS_mod = NULL; <span class="comment">// Initialise a small portion of memory, will make it bigger later on...</span>
00079        u8 i;
00080        <span class="keywordflow">for</span> (i = 0; i &lt; 16; i++) FS_wav[i] = NULL; <span class="comment">// to be able to free</span>
00081 }
00082 
00083 
00084 
00108 <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga2">PA_PlaySoundEx</a>(u8 PA_Channel, <span class="keyword">const</span> <span class="keywordtype">void</span>* data, s32 length, u8 volume, s32 freq, s16 format);
00109 
<a name="l00130"></a><a class="code" href="group___sound_a_r_m9.html#ga3">00130</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga3">PA_PlayGBFSSoundEx</a>(u8 PA_Channel, u16 FS_wav_number, u8 volume, s32 freq, s16 format){
00131 s32 length = (PA_GBFSfile[FS_wav_number].Length &gt;&gt; 2) + 1; <span class="comment">// Pour etre sur...</span>
00132        free(FS_wav[PA_Channel]);
00133        FS_wav[PA_Channel] = (u32*)malloc(length &lt;&lt; 2);
00134        
00135        DMA_Copy(PA_GBFSfile[FS_wav_number].File, FS_wav[PA_Channel], length, DMA_32NOW);
00136 
00137        <a class="code" href="group___sound_a_r_m9.html#ga2">PA_PlaySoundEx</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, volume, freq, format);
00138 }
00139 
00140 
00141 
<a name="l00162"></a><a class="code" href="group___sound_a_r_m9.html#ga4">00162</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga4">PA_PlayFSSoundEx</a>(u8 PA_Channel, u16 PAFS_wav_number, u8 volume, s32 freq, s16 format){
00163        <a class="code" href="group___p_a_f_s.html#ga4">PA_Malloc</a>((<span class="keywordtype">void</span>**)&amp;FS_wav[PA_Channel], PA_FSFile[PAFS_wav_number].Length+4);
00164 
00165        s32 i;
00166        s32 length = (PA_FSFile[PAFS_wav_number].Length&gt;&gt;2) + 1; <span class="comment">// Pour etre sur...</span>
00167        <span class="keywordflow">for</span> (i = 0; i &lt; length; i++) FS_wav[PA_Channel][i] = ((u32*)<a class="code" href="group___p_a_f_s.html#ga5">PA_PAFSFile</a>(PAFS_wav_number))[i];
00168        
00169        <a class="code" href="group___sound_a_r_m9.html#ga2">PA_PlaySoundEx</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, volume, freq, format);
00170 }
00171 
00172 
<a name="l00193"></a><a class="code" href="group___sound_a_r_m9.html#ga5">00193</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga5">PA_PlaySound</a>(u8 PA_Channel, <span class="keyword">const</span> <span class="keywordtype">void</span>* data, s32 length, u8 volume, s32 freq){
00194 <a class="code" href="group___sound_a_r_m9.html#ga2">PA_PlaySoundEx</a>(PA_Channel, data, length, volume, freq, 0);
00195 }
00196 
<a name="l00214"></a><a class="code" href="group___sound_a_r_m9.html#ga6">00214</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga6">PA_PlayGBFSSound</a>(u8 PA_Channel, u16 FS_wav_number, u8 volume, s32 freq){
00215 s32 length = (PA_GBFSfile[FS_wav_number].Length &gt;&gt; 2) + 1; <span class="comment">// Pour etre sur...</span>
00216        free(FS_wav[PA_Channel]);
00217        FS_wav[PA_Channel] = (u32*)malloc(length &lt;&lt; 2);
00218        
00219        DMA_Copy(PA_GBFSfile[FS_wav_number].File, FS_wav[PA_Channel], length, DMA_32NOW);
00220 
00221        <a class="code" href="group___sound_a_r_m9.html#ga5">PA_PlaySound</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, volume, freq);
00222 }
00223 
00224 
00225 
<a name="l00243"></a><a class="code" href="group___sound_a_r_m9.html#ga7">00243</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga7">PA_PlayFSSound</a>(u8 PA_Channel, u16 PAFS_wav_number, u8 volume, s32 freq){
00244        <a class="code" href="group___p_a_f_s.html#ga4">PA_Malloc</a>((<span class="keywordtype">void</span>**)(&amp;FS_wav[PA_Channel]), PA_FSFile[PAFS_wav_number].Length+4);
00245 
00246        s32 i;
00247        s32 length = (PA_FSFile[PAFS_wav_number].Length&gt;&gt;2) + 1; <span class="comment">// Pour etre sur...</span>
00248        <span class="keywordflow">for</span> (i = 0; i &lt; length; i++) FS_wav[PA_Channel][i] = ((u32*)<a class="code" href="group___p_a_f_s.html#ga5">PA_PAFSFile</a>(PAFS_wav_number))[i];
00249        
00250        <a class="code" href="group___sound_a_r_m9.html#ga5">PA_PlaySound</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, volume, freq);
00251 }
00252 
00253 
00254 
<a name="l00267"></a><a class="code" href="group___sound_a_r_m9.html#ga12">00267</a> <span class="preprocessor">#define PA_PlaySimpleSound(PA_Channel, sound) PA_PlaySoundEx(PA_Channel, (void*)sound, (u32)sound##_size, PA_SoundOption.volume, PA_SoundOption.freq, PA_SoundOption.format)</span>
00268 <span class="preprocessor"></span>
00269 
<a name="l00281"></a><a class="code" href="group___sound_a_r_m9.html#ga8">00281</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga8">PA_PlayGBFSSimpleSound</a>(u8 PA_Channel, u16 FS_wav_number){
00282 s32 length = (PA_GBFSfile[FS_wav_number].Length &gt;&gt; 2) + 1; <span class="comment">// Pour etre sur...</span>
00283        free(FS_wav[PA_Channel]);
00284        FS_wav[PA_Channel] = (u32*)malloc(length &lt;&lt; 2);
00285        
00286        DMA_Copy(PA_GBFSfile[FS_wav_number].File, FS_wav[PA_Channel], length, DMA_32NOW);
00287 
00288        <a class="code" href="group___sound_a_r_m9.html#ga5">PA_PlaySound</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], length &lt;&lt; 2, PA_SoundOption.volume, PA_SoundOption.freq);
00289 }
00290 
00291 
00292 
00293 
<a name="l00305"></a><a class="code" href="group___sound_a_r_m9.html#ga9">00305</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga9">PA_PlayFSSimpleSound</a>(u8 PA_Channel, u16 PAFS_wav_number){
00306        <a class="code" href="group___p_a_f_s.html#ga4">PA_Malloc</a>((<span class="keywordtype">void</span>**)(&amp;FS_wav[PA_Channel]), PA_FSFile[PAFS_wav_number].Length+4);
00307 
00308        s32 i;
00309        s32 length = (PA_FSFile[PAFS_wav_number].Length&gt;&gt;2) + 1; <span class="comment">// Pour etre sur...</span>
00310        <span class="keywordflow">for</span> (i = 0; i &lt; length; i++) FS_wav[PA_Channel][i] = ((u32*)<a class="code" href="group___p_a_f_s.html#ga5">PA_PAFSFile</a>(PAFS_wav_number))[i];
00311        
00312        <a class="code" href="group___sound_a_r_m9.html#ga5">PA_PlaySound</a>(PA_Channel, (<span class="keywordtype">void</span>*)FS_wav[PA_Channel], PA_FSFile[PAFS_wav_number].Length, PA_SoundOption.volume, PA_SoundOption.freq);
00313 }
00314 
00315 
00316 
00317 
00318 
00319 
<a name="l00328"></a><a class="code" href="group___sound_a_r_m9.html#ga13">00328</a> <span class="preprocessor">#define PA_PlayMod(mod_snd) SndPlayMOD((u8*)mod_snd)</span>
00329 <span class="preprocessor"></span>
00330 
<a name="l00339"></a><a class="code" href="group___sound_a_r_m9.html#ga10">00339</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga10">PA_PlayGBFSMod</a>(u16 FS_mod_number){
00340 s32 length = (PA_GBFSfile[FS_mod_number].Length &gt;&gt; 2) + 1; <span class="comment">// Pour etre sur...</span>
00341        free(FS_mod);
00342        FS_mod = (u32*)malloc(length &lt;&lt; 2);
00343 
00344        DMA_Copy(PA_GBFSfile[FS_mod_number].File, FS_mod, length, DMA_32NOW);
00345 
00346        <a class="code" href="group___sound_a_r_m9.html#ga13">PA_PlayMod</a>(FS_mod);
00347 }
00348 
00349 
<a name="l00358"></a><a class="code" href="group___sound_a_r_m9.html#ga11">00358</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___sound_a_r_m9.html#ga11">PA_PlayFSMod</a>(u16 PAFS_mod_number){
00359        <a class="code" href="group___p_a_f_s.html#ga4">PA_Malloc</a>((<span class="keywordtype">void</span>**)((u32)(&amp;FS_mod)), PA_FSFile[PAFS_mod_number].Length+4);
00360 
00361        s32 i;
00362        s32 length = (PA_FSFile[PAFS_mod_number].Length&gt;&gt;2) + 1; <span class="comment">// Pour etre sur...</span>
00363        <span class="keywordflow">for</span> (i = 0; i &lt; length; i++) FS_mod[i] = ((u32*)<a class="code" href="group___p_a_f_s.html#ga5">PA_PAFSFile</a>(PAFS_mod_number))[i];
00364        
00365        <a class="code" href="group___sound_a_r_m9.html#ga13">PA_PlayMod</a>(FS_mod);
00366 }
00367 
00368 
00369 
00370 
00371 
00372 
00373 
<a name="l00379"></a><a class="code" href="group___sound_a_r_m9.html#ga14">00379</a> <span class="preprocessor">#define PA_StopMod() SndStopMOD()</span>
00380 <span class="preprocessor"></span>
00381 
<a name="l00390"></a><a class="code" href="group___sound_a_r_m9.html#ga15">00390</a> <span class="preprocessor">#define PA_PauseMod(bool) SndPauseMOD(bool)</span>
00391 <span class="preprocessor"></span>
00392  <span class="comment">// end of SoundARM9</span>
00394 
00395 
00396 
00397 <span class="preprocessor">#endif</span>
00398 <span class="preprocessor"></span>
00399 
</pre></div><hr size="1"><address style="align: right;"><small>Généré le Sun Jan 22 11:46:51 2006 pour PAlib par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
