<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PAlib:  Fichier source de PA_Interrupt.h</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Généré par Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Page&nbsp;principale</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">Liste&nbsp;des&nbsp;fichiers</a> | <a class="qindex" href="globals.html">Portée&nbsp;globale</a>  | <span class="search">Rechercher&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>PA_Interrupt.h</h1><a href="_p_a___interrupt_8h.html">Aller à la documentation de ce fichier.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef _PA_Interrupt</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define _PA_Interrupt</span>
00003 <span class="preprocessor"></span>
00004 <span class="preprocessor">#ifdef __cplusplus</span>
00005 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00006 <span class="preprocessor">#endif</span>
00007 <span class="preprocessor"></span>
00014 <span class="keyword">typedef</span> void(*funcpointer)(void);
00015 
00016 <span class="keyword">extern</span> <span class="keyword">volatile</span> <span class="keywordtype">bool</span> PA_Newframe;
00017 
00018 <span class="keyword">extern</span> <span class="keyword">volatile</span> <span class="keywordtype">bool</span> PA_vblok; <span class="comment">// Passe à 1 quand VBL activé...</span>
00019 
00020 
00021 <span class="keyword">extern</span> u32 PA_CPU; <span class="comment">// Pourcentage CPU...</span>
00022 <span class="keyword">extern</span> u32 PA_MaxCPU; <span class="comment">// Max CPU...</span>
00023 <span class="keyword">extern</span> u32 PA_lines; <span class="comment">// Nombre de lignes, pour faire le calcul...</span>
00024 <span class="keyword">extern</span> u8 PA_VBLCount; <span class="comment">// Compte le nombre de VBL avant qu'on en arrive à un tour</span>
00025 <span class="keyword">extern</span> u8 PA_nVBLs;
00026 
00027 
00028 
00029 <span class="comment">//Interrupt Registers</span>
00030 <span class="preprocessor">#ifndef REG_IME</span>
00031 <span class="preprocessor"></span><span class="preprocessor">       #define REG_IME *(u32*)0x04000208</span>
00032 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00033 <span class="preprocessor"></span><span class="preprocessor">#ifndef REG_IE</span>
00034 <span class="preprocessor"></span><span class="preprocessor">#define REG_IE *(u32*)0x04000210</span>
00035 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00036 <span class="preprocessor"></span><span class="preprocessor">#ifndef REG_IF</span>
00037 <span class="preprocessor"></span><span class="preprocessor">#define REG_IF *(u32*)0x04000214</span>
00038 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00039 <span class="preprocessor"></span>
00040 
00041 <span class="preprocessor">#define REG_INTERRUPT IRQ_HANDLER //*(u32*)0x3007FFC</span>
00042 <span class="preprocessor"></span><span class="preprocessor">#define REG_DISPSTAT DISP_SR //*(u16*)0x4000004</span>
00043 <span class="preprocessor"></span>
00044 
00045 <span class="preprocessor">#define REG_VCOUNT _REG16(0x04000006)</span>
00046 <span class="preprocessor"></span>
00047 <span class="comment">// Interrupts</span>
00048 <span class="preprocessor">#define INTVBLANK 0x0001</span>
00049 <span class="preprocessor"></span><span class="preprocessor">#define INTHBLANK 0x0002</span>
00050 <span class="preprocessor"></span><span class="preprocessor">#define INTVCOUNT 0x0004</span>
00051 <span class="preprocessor"></span><span class="preprocessor">#define INTTIMER0 0x0008</span>
00052 <span class="preprocessor"></span><span class="preprocessor">#define INTTIMER1 0x0010</span>
00053 <span class="preprocessor"></span><span class="preprocessor">#define INTTIMER2 0x0020</span>
00054 <span class="preprocessor"></span><span class="preprocessor">#define INTTIMER3 0x0040</span>
00055 <span class="preprocessor"></span><span class="preprocessor">#define INTCOM 0x0080</span>
00056 <span class="preprocessor"></span><span class="preprocessor">#define INTDMA0 0x0100</span>
00057 <span class="preprocessor"></span><span class="preprocessor">#define INTDMA1 0x0200</span>
00058 <span class="preprocessor"></span><span class="preprocessor">#define INTDMA2 0x0400</span>
00059 <span class="preprocessor"></span><span class="preprocessor">#define INTDMA3 0x0800</span>
00060 <span class="preprocessor"></span><span class="preprocessor">#define INTBUTTON 0x1000</span>
00061 <span class="preprocessor"></span><span class="preprocessor">#define INTCART 0x2000</span>
00062 <span class="preprocessor"></span>
00063 <span class="preprocessor">#define INT_VBLANK 0</span>
00064 <span class="preprocessor"></span><span class="preprocessor">#define INT_HBLANK 1</span>
00065 <span class="preprocessor"></span><span class="preprocessor">#define INT_VCOUNT 2</span>
00066 <span class="preprocessor"></span><span class="preprocessor">#define INT_TIMER0 3</span>
00067 <span class="preprocessor"></span><span class="preprocessor">#define INT_TIMER1 4</span>
00068 <span class="preprocessor"></span><span class="preprocessor">#define INT_TIMER2 5</span>
00069 <span class="preprocessor"></span><span class="preprocessor">#define INT_TIMER3 6</span>
00070 <span class="preprocessor"></span><span class="preprocessor">#define INT_COM 7</span>
00071 <span class="preprocessor"></span><span class="preprocessor">#define INT_DMA0 8</span>
00072 <span class="preprocessor"></span><span class="preprocessor">#define INT_DMA1 9</span>
00073 <span class="preprocessor"></span><span class="preprocessor">#define INT_DMA2 10</span>
00074 <span class="preprocessor"></span><span class="preprocessor">#define INT_DMA3 11</span>
00075 <span class="preprocessor"></span><span class="preprocessor">#define INT_KEY 12</span>
00076 <span class="preprocessor"></span><span class="preprocessor">#define INT_CART 13</span>
00077 <span class="preprocessor"></span>
00078 <span class="preprocessor">#define ENABLE_VBLANK 8</span>
00079 <span class="preprocessor"></span><span class="preprocessor">#define ENABLE_HBLANK 16</span>
00080 <span class="preprocessor"></span><span class="preprocessor">#define ENABLE_VCOUNT 32</span>
00081 <span class="preprocessor"></span>
00082 
00083 <span class="comment">// Pour activer les timers, que pour moi...</span>
00084 <span class="comment">// TIMER O</span>
00085 <span class="preprocessor">#define TIMER0COUNT         *(volatile u16 *)(0x04000100)</span>
00086 <span class="preprocessor"></span><span class="preprocessor">#define TIMER0CNT           *(volatile u16 *)(0x04000102)</span>
00087 <span class="preprocessor"></span><span class="preprocessor">#define TIMER0CNT_TIMER_START               (TIMER0CNT |= 0x0080)</span>
00088 <span class="preprocessor"></span><span class="preprocessor">#define TIMER0CNT_IRQ_ENABLE                (TIMER0CNT |= 0x0040)</span>
00089 <span class="preprocessor"></span><span class="preprocessor">#define PA_EnableTimer0() {TIMER0CNT_TIMER_START; TIMER0CNT_IRQ_ENABLE;}</span>
00090 <span class="preprocessor"></span>
00091 <span class="preprocessor">#define TIMER0CNT_TIMER_STOP                (TIMER0CNT &amp;= 0xFF7F)</span>
00092 <span class="preprocessor"></span><span class="preprocessor">#define TIMER0CNT_IRQ_DISABLE               (TIMER0CNT &amp;= 0xFFBF)</span>
00093 <span class="preprocessor"></span><span class="preprocessor">#define PA_DisableTimer0() {TIMER0CNT_TIMER_STOP; TIMER0CNT_IRQ_DISABLE;}</span>
00094 <span class="preprocessor"></span>
00095 <span class="comment">// TIMER 1</span>
00096 <span class="preprocessor">#define TIMER1COUNT         *(volatile u16 *)(0x04000104)</span>
00097 <span class="preprocessor"></span><span class="preprocessor">#define TIMER1CNT           *(volatile u16 *)(0x04000106)</span>
00098 <span class="preprocessor"></span><span class="preprocessor">#define TIMER1CNT_TIMER_START               (TIMER1CNT |= 0x0080)</span>
00099 <span class="preprocessor"></span><span class="preprocessor">#define TIMER1CNT_IRQ_ENABLE                (TIMER1CNT |= 0x0040)</span>
00100 <span class="preprocessor"></span><span class="preprocessor">#define PA_EnableTimer1() {TIMER1CNT_TIMER_START; TIMER1CNT_IRQ_ENABLE;}</span>
00101 <span class="preprocessor"></span>
00102 <span class="preprocessor">#define TIMER1CNT_TIMER_STOP                (TIMER1CNT &amp;= 0xFF7F)</span>
00103 <span class="preprocessor"></span><span class="preprocessor">#define TIMER1CNT_IRQ_DISABLE               (TIMER1CNT &amp;= 0xFFBF)</span>
00104 <span class="preprocessor"></span><span class="preprocessor">#define PA_DisableTimer1() {TIMER1CNT_TIMER_STOP; TIMER1CNT_IRQ_DISABLE;}</span>
00105 <span class="preprocessor"></span>
00106 <span class="comment">// TIMER 2</span>
00107 <span class="preprocessor">#define TIMER2COUNT         *(volatile u16 *)(0x04000108)</span>
00108 <span class="preprocessor"></span><span class="preprocessor">#define TIMER2CNT           *(volatile u16 *)(0x0400010A)</span>
00109 <span class="preprocessor"></span><span class="preprocessor">#define TIMER2CNT_TIMER_START               (TIMER2CNT |= 0x0080)</span>
00110 <span class="preprocessor"></span><span class="preprocessor">#define TIMER2CNT_IRQ_ENABLE                (TIMER2CNT |= 0x0040)</span>
00111 <span class="preprocessor"></span><span class="preprocessor">#define PA_EnableTimer2() {TIMER2CNT_TIMER_START; TIMER2CNT_IRQ_ENABLE;}</span>
00112 <span class="preprocessor"></span>
00113 <span class="preprocessor">#define TIMER2CNT_TIMER_STOP                (TIMER2CNT &amp;= 0xFF7F)</span>
00114 <span class="preprocessor"></span><span class="preprocessor">#define TIMER2CNT_IRQ_DISABLE               (TIMER2CNT &amp;= 0xFFBF)</span>
00115 <span class="preprocessor"></span><span class="preprocessor">#define PA_DisableTimer2() {TIMER2CNT_TIMER_STOP; TIMER2CNT_IRQ_DISABLE;}</span>
00116 <span class="preprocessor"></span>
00117 <span class="comment">// TIMER 3</span>
00118 <span class="preprocessor">#define TIMER3COUNT         *(volatile u16 *)(0x0400010C)</span>
00119 <span class="preprocessor"></span><span class="preprocessor">#define TIMER3CNT           *(volatile u16 *)(0x0400010E)</span>
00120 <span class="preprocessor"></span><span class="preprocessor">#define TIMER3CNT_TIMER_START               (TIMER3CNT |= 0x0080)</span>
00121 <span class="preprocessor"></span><span class="preprocessor">#define TIMER3CNT_IRQ_ENABLE                (TIMER3CNT |= 0x0040)</span>
00122 <span class="preprocessor"></span><span class="preprocessor">#define PA_EnableTimer3() {TIMER3CNT_TIMER_START; TIMER3CNT_IRQ_ENABLE;}</span>
00123 <span class="preprocessor"></span>
00124 <span class="preprocessor">#define TIMER3CNT_TIMER_STOP                (TIMER3CNT &amp;= 0xFF7F)</span>
00125 <span class="preprocessor"></span><span class="preprocessor">#define TIMER3CNT_IRQ_DISABLE               (TIMER3CNT &amp;= 0xFFBF)</span>
00126 <span class="preprocessor"></span><span class="preprocessor">#define PA_DisableTimer3() {TIMER3CNT_TIMER_STOP; TIMER3CNT_IRQ_DISABLE;}</span>
00127 <span class="preprocessor"></span>
00128 
00129 
00130 
00131 <span class="keyword">extern</span> funcpointer interruptfunc[14];
00132 
00133 
00134 <span class="keywordtype">void</span> interruptfunction(<span class="keywordtype">void</span>);
00135 
<a name="l00149"></a><a class="code" href="group___interrupts.html#ga4">00149</a> <span class="preprocessor">#define PA_InitVBL() PA_StartInt(INT_VBLANK, PA_vblFunc)</span>
00150 <span class="preprocessor"></span>
00157 <span class="keywordtype">void</span> <a class="code" href="group___interrupts.html#ga0">PA_ResetInterrupts</a>(<span class="keywordtype">void</span>);
00158 
00172 <span class="keywordtype">void</span> <a class="code" href="group___interrupts.html#ga1">PA_StartInt</a>(u8 inter, funcpointer interfunc);
00173 
00174 
00183 <span class="keywordtype">void</span> <a class="code" href="group___interrupts.html#ga2">PA_StopInt</a>(u8 inter);
00184 
00185 
<a name="l00191"></a><a class="code" href="group___interrupts.html#ga5">00191</a> <span class="preprocessor">#define PA_GetVcount() (REG_VCOUNT&amp;511)</span>
00192 <span class="preprocessor"></span>
00198 <span class="keywordtype">void</span> <a class="code" href="group___interrupts.html#ga3">PA_vblFunc</a>(<span class="keywordtype">void</span>);
00199  <span class="comment">// end of Interrupts</span>
00201 
00202 <span class="preprocessor">#ifdef __cplusplus</span>
00203 <span class="preprocessor"></span>}
00204 <span class="preprocessor">#endif</span>
00205 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00206 <span class="preprocessor"></span>
00207 
</pre></div><hr size="1"><address style="align: right;"><small>Généré le Thu Feb 9 15:38:26 2006 pour PAlib par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
