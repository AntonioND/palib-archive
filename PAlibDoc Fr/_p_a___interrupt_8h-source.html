<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PAlib:  Fichier source de PA_Interrupt.h</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Généré par Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Page&nbsp;principale</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">Liste&nbsp;des&nbsp;fichiers</a> | <a class="qindex" href="globals.html">Portée&nbsp;globale</a>  | <span class="search">Rechercher&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>PA_Interrupt.h</h1><a href="_p_a___interrupt_8h.html">Aller à la documentation de ce fichier.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef _PA_Interrupt</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define _PA_Interrupt</span>
00003 <span class="preprocessor"></span>
00004 <span class="preprocessor">#ifdef __cplusplus</span>
00005 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00006 <span class="preprocessor">#endif</span>
00007 <span class="preprocessor"></span>
00014 <span class="keyword">typedef</span> void(*funcpointer)(void);
00015 
00016 <span class="keyword">extern</span> <span class="keyword">volatile</span> u8 PA_Newframe;
00017 
00018 <span class="keyword">extern</span> <span class="keyword">volatile</span> u8 PA_vblok; <span class="comment">// Passe à 1 quand VBL activé...</span>
00019 
00020 
00021 <span class="keyword">extern</span> u32 PA_CPU; <span class="comment">// Pourcentage CPU...</span>
00022 <span class="keyword">extern</span> u32 PA_MaxCPU; <span class="comment">// Max CPU...</span>
00023 <span class="keyword">extern</span> u32 PA_lines; <span class="comment">// Nombre de lignes, pour faire le calcul...</span>
00024 <span class="keyword">extern</span> u8 PA_VBLCount; <span class="comment">// Compte le nombre de VBL avant qu'on en arrive à un tour</span>
00025 <span class="keyword">extern</span> u8 PA_nVBLs;
00026 <span class="keyword">extern</span> s32 PA_VBLCounter[16];  <span class="comment">// VBL counters available</span>
00027 <span class="keyword">extern</span> <span class="keywordtype">bool</span> PA_VBLCounterOn[16];  <span class="comment">// On or off</span>
00028 
00029 <span class="keyword">extern</span> funcpointer CustomVBL;
00030 
00031 <span class="comment">/*</span>
00032 <span class="comment">//Interrupt Registers</span>
00033 <span class="comment">#ifndef REG_IME</span>
00034 <span class="comment">       #define REG_IME *(u32*)0x04000208</span>
00035 <span class="comment">#endif</span>
00036 <span class="comment">#ifndef REG_IE</span>
00037 <span class="comment">#define REG_IE *(u32*)0x04000210</span>
00038 <span class="comment">#endif</span>
00039 <span class="comment">#ifndef REG_IF</span>
00040 <span class="comment">#define REG_IF *(u32*)0x04000214</span>
00041 <span class="comment">#endif*/</span>
00042 
00043 <span class="comment">/*</span>
00044 <span class="comment">#define REG_INTERRUPT IRQ_HANDLE</span>
00045 <span class="comment">#define REG_DISPSTAT DISP_SR</span>
00046 <span class="comment">*/</span>
00047 
00048 <span class="comment">//#define REG_VCOUNT _REG16(0x04000006)</span>
00049 <span class="comment">/*</span>
00050 <span class="comment">// Interrupts</span>
00051 <span class="comment">#define INTVBLANK 0x0001</span>
00052 <span class="comment">#define INTHBLANK 0x0002</span>
00053 <span class="comment">#define INTVCOUNT 0x0004</span>
00054 <span class="comment">#define INTTIMER0 0x0008</span>
00055 <span class="comment">#define INTTIMER1 0x0010</span>
00056 <span class="comment">#define INTTIMER2 0x0020</span>
00057 <span class="comment">#define INTTIMER3 0x0040</span>
00058 <span class="comment">#define INTCOM 0x0080</span>
00059 <span class="comment">#define INTDMA0 0x0100</span>
00060 <span class="comment">#define INTDMA1 0x0200</span>
00061 <span class="comment">#define INTDMA2 0x0400</span>
00062 <span class="comment">#define INTDMA3 0x0800</span>
00063 <span class="comment">#define INTBUTTON 0x1000</span>
00064 <span class="comment">#define INTCART 0x2000</span>
00065 <span class="comment"></span>
00066 <span class="comment">#define INT_VBLANK 0</span>
00067 <span class="comment">#define INT_HBLANK 1</span>
00068 <span class="comment">#define INT_VCOUNT 2</span>
00069 <span class="comment">#define INT_TIMER0 3</span>
00070 <span class="comment">#define INT_TIMER1 4</span>
00071 <span class="comment">#define INT_TIMER2 5</span>
00072 <span class="comment">#define INT_TIMER3 6</span>
00073 <span class="comment">#define INT_COM 7</span>
00074 <span class="comment">#define INT_DMA0 8</span>
00075 <span class="comment">#define INT_DMA1 9</span>
00076 <span class="comment">#define INT_DMA2 10</span>
00077 <span class="comment">#define INT_DMA3 11</span>
00078 <span class="comment">#define INT_KEY 12</span>
00079 <span class="comment">#define INT_CART 13*/</span>
00080 
00081 <span class="preprocessor">#define ENABLE_VBLANK 8</span>
00082 <span class="preprocessor"></span><span class="preprocessor">#define ENABLE_HBLANK 16</span>
00083 <span class="preprocessor"></span><span class="preprocessor">#define ENABLE_VCOUNT 32</span>
00084 <span class="preprocessor"></span>
00085 <span class="comment">/*</span>
00086 <span class="comment">// Pour activer les timers, que pour moi...</span>
00087 <span class="comment">// TIMER O</span>
00088 <span class="comment">#define TIMER0COUNT         *(volatile u16 *)(0x04000100)</span>
00089 <span class="comment">#define TIMER0CNT           *(volatile u16 *)(0x04000102)</span>
00090 <span class="comment">#define TIMER0CNT_TIMER_START               (TIMER0CNT |= 0x0080)</span>
00091 <span class="comment">#define TIMER0CNT_IRQ_ENABLE                (TIMER0CNT |= 0x0040)</span>
00092 <span class="comment">#define PA_EnableTimer0() {TIMER0CNT_TIMER_START; TIMER0CNT_IRQ_ENABLE;}</span>
00093 <span class="comment"></span>
00094 <span class="comment">#define TIMER0CNT_TIMER_STOP                (TIMER0CNT &amp;= 0xFF7F)</span>
00095 <span class="comment">#define TIMER0CNT_IRQ_DISABLE               (TIMER0CNT &amp;= 0xFFBF)</span>
00096 <span class="comment">#define PA_DisableTimer0() {TIMER0CNT_TIMER_STOP; TIMER0CNT_IRQ_DISABLE;}</span>
00097 <span class="comment"></span>
00098 <span class="comment">// TIMER 1</span>
00099 <span class="comment">#define TIMER1COUNT         *(volatile u16 *)(0x04000104)</span>
00100 <span class="comment">#define TIMER1CNT           *(volatile u16 *)(0x04000106)</span>
00101 <span class="comment">#define TIMER1CNT_TIMER_START               (TIMER1CNT |= 0x0080)</span>
00102 <span class="comment">#define TIMER1CNT_IRQ_ENABLE                (TIMER1CNT |= 0x0040)</span>
00103 <span class="comment">#define PA_EnableTimer1() {TIMER1CNT_TIMER_START; TIMER1CNT_IRQ_ENABLE;}</span>
00104 <span class="comment"></span>
00105 <span class="comment">#define TIMER1CNT_TIMER_STOP                (TIMER1CNT &amp;= 0xFF7F)</span>
00106 <span class="comment">#define TIMER1CNT_IRQ_DISABLE               (TIMER1CNT &amp;= 0xFFBF)</span>
00107 <span class="comment">#define PA_DisableTimer1() {TIMER1CNT_TIMER_STOP; TIMER1CNT_IRQ_DISABLE;}</span>
00108 <span class="comment"></span>
00109 <span class="comment">// TIMER 2</span>
00110 <span class="comment">#define TIMER2COUNT         *(volatile u16 *)(0x04000108)</span>
00111 <span class="comment">#define TIMER2CNT           *(volatile u16 *)(0x0400010A)</span>
00112 <span class="comment">#define TIMER2CNT_TIMER_START               (TIMER2CNT |= 0x0080)</span>
00113 <span class="comment">#define TIMER2CNT_IRQ_ENABLE                (TIMER2CNT |= 0x0040)</span>
00114 <span class="comment">#define PA_EnableTimer2() {TIMER2CNT_TIMER_START; TIMER2CNT_IRQ_ENABLE;}</span>
00115 <span class="comment"></span>
00116 <span class="comment">#define TIMER2CNT_TIMER_STOP                (TIMER2CNT &amp;= 0xFF7F)</span>
00117 <span class="comment">#define TIMER2CNT_IRQ_DISABLE               (TIMER2CNT &amp;= 0xFFBF)</span>
00118 <span class="comment">#define PA_DisableTimer2() {TIMER2CNT_TIMER_STOP; TIMER2CNT_IRQ_DISABLE;}</span>
00119 <span class="comment"></span>
00120 <span class="comment">// TIMER 3</span>
00121 <span class="comment">#define TIMER3COUNT         *(volatile u16 *)(0x0400010C)</span>
00122 <span class="comment">#define TIMER3CNT           *(volatile u16 *)(0x0400010E)</span>
00123 <span class="comment">#define TIMER3CNT_TIMER_START               (TIMER3CNT |= 0x0080)</span>
00124 <span class="comment">#define TIMER3CNT_IRQ_ENABLE                (TIMER3CNT |= 0x0040)</span>
00125 <span class="comment">#define PA_EnableTimer3() {TIMER3CNT_TIMER_START; TIMER3CNT_IRQ_ENABLE;}</span>
00126 <span class="comment"></span>
00127 <span class="comment">#define TIMER3CNT_TIMER_STOP                (TIMER3CNT &amp;= 0xFF7F)</span>
00128 <span class="comment">#define TIMER3CNT_IRQ_DISABLE               (TIMER3CNT &amp;= 0xFFBF)</span>
00129 <span class="comment">#define PA_DisableTimer3() {TIMER3CNT_TIMER_STOP; TIMER3CNT_IRQ_DISABLE;}</span>
00130 <span class="comment"></span>
00131 <span class="comment">*/</span>
00132 
00133 
00134 <span class="comment">//extern funcpointer interruptfunc[14];</span>
00135 
00136 
00137 <span class="keywordtype">void</span> interruptfunction(<span class="keywordtype">void</span>);
00138 
00150 <span class="keywordtype">void</span> <a class="code" href="group___interrupts.html#ga0">PA_vblFunc</a>(<span class="keywordtype">void</span>);
00151 
00152 
00161 <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> PA_InitVBL(<span class="keywordtype">void</span>) {
00162        <span class="comment">//irqInit();</span>
00163        irqSet(IRQ_VBLANK, PA_vblFunc);
00164        irqEnable(IRQ_VBLANK);
00165 }
00166 
00167 <span class="comment">//PA_StartInt(INT_VBLANK, PA_vblFunc)</span>
00168 
00169 
00176 <span class="comment">//void PA_ResetInterrupts(void);</span>
00177 
00191 <span class="comment">//void PA_StartInt(u8 inter, funcpointer interfunc);</span>
00192 <span class="comment">/*extern inline void PA_StartInt(u8 inter, funcpointer interfunc){</span>
00193 <span class="comment">       irqSet(inter, interfunc);</span>
00194 <span class="comment">       irqEnable(inter);</span>
00195 <span class="comment">}*/</span>
00196 
00205 <span class="comment">/*extern inline void PA_StopInt(u8 inter){</span>
00206 <span class="comment">       irqDisable(inter);</span>
00207 <span class="comment">}*/</span>
00208 
00209 
<a name="l00215"></a><a class="code" href="group___interrupts.html#ga8">00215</a> <span class="preprocessor">#define PA_GetVcount() (REG_VCOUNT&amp;511)</span>
00216 <span class="preprocessor"></span>
00222 <span class="keywordtype">void</span> PA_VBLCountersReset(<span class="keywordtype">void</span>);
00223 
<a name="l00232"></a><a class="code" href="group___interrupts.html#ga3">00232</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___interrupts.html#ga3">PA_VBLCounterStart</a>(u8 nCounter){
00233        PA_VBLCounter[nCounter] = 0;
00234        PA_VBLCounterOn[nCounter] = 1;
00235 }
00236 
<a name="l00245"></a><a class="code" href="group___interrupts.html#ga4">00245</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___interrupts.html#ga4">PA_VBLCounterPause</a>(u8 nCounter){
00246        PA_VBLCounterOn[nCounter] = 0;
00247 }
00248 
00249 
<a name="l00258"></a><a class="code" href="group___interrupts.html#ga5">00258</a> <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group___interrupts.html#ga5">PA_VBLCounterUnpause</a>(u8 nCounter){
00259        PA_VBLCounterOn[nCounter] = 1;
00260 }
00261 
00262 
00263 <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> PA_VBLFunctionInit(funcpointer VBLFunc){
00264        CustomVBL = VBLFunc;
00265 }
00266 
00267 <span class="keyword">extern</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> PA_VBLFunctionReset(<span class="keywordtype">void</span>){
00268        PA_VBLFunctionInit(PA_Nothing);
00269 }
00270 
00271 
00272 
00273 
00274 
00275 
00276 
00277  <span class="comment">// end of Interrupts</span>
00279 
00280 <span class="preprocessor">#ifdef __cplusplus</span>
00281 <span class="preprocessor"></span>}
00282 <span class="preprocessor">#endif</span>
00283 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00284 <span class="preprocessor"></span>
00285 
</pre></div><hr size="1"><address style="align: right;"><small>Généré le Tue Sep 5 20:35:54 2006 pour PAlib par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
